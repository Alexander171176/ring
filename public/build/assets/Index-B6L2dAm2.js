import{u as U,m as u,o as i,f as e,t as l,k as n,F as T,v as A,n as w,i as p,y as I,l as v,C as V,E as C,G as P,e as S,w as h,p as D}from"./vendor-RLSRVg0u.js";import{A as M}from"./AdminLayout-D5xFEmFM.js";import{T as F}from"./TitlePage-FZyLO7ZL.js";import{_ as H,a as O,b as z}from"./CountTable-BB0DAeyh.js";import{_ as G,a as Q,b as q}from"./SearchInput-CHCcR2M1.js";import{_ as J}from"./IconEdit-BtD_rftc.js";import{_ as K}from"./DefaultButton-nL57tpOx.js";import"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-xl9ghVBF.js";import"./ScrollButtons-Bf8O8t11.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationMark-xXghvFch.js";import"./ResponsiveNavLink-BMppKKTO.js";import"./LocaleSelectOption-DaW_oD0g.js";import"./app-sk5ydQhe.js";import"./auth-image-XbvYdkSi.js";const R={class:"bg-white dark:bg-slate-700 shadow-lg rounded-sm border border-slate-200 dark:border-slate-600 relative"},W={class:"overflow-x-auto"},X={key:0,class:"table-auto w-full text-slate-700 dark:text-slate-100"},Y={class:"text-sm font-semibold uppercase bg-slate-200 dark:bg-cyan-900 border border-solid border-gray-300 dark:border-gray-700"},Z={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},ee={class:"font-semibold text-left"},te={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},se={class:"font-semibold text-left"},ae={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},re={class:"font-semibold text-left"},oe={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},le={class:"font-semibold text-end"},ne={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap text-teal-600 dark:text-violet-200 hover:bg-slate-100 dark:hover:bg-cyan-800"},ie={class:"text-left"},de={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap text-blue-600 dark:text-blue-200 hover:bg-slate-100 dark:hover:bg-cyan-800"},ce={class:"text-left"},ue={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},me={class:"flex flex-wrap gap-1"},pe={key:0,class:"text-xs italic text-gray-500"},fe={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},_e={class:"flex justify-end space-x-2"},ve={key:1,class:"p-5 text-center text-slate-700 dark:text-slate-100"},he={__name:"UserTable",props:{users:Array},emits:["edit","delete"],setup(c,{emit:m}){const{t:o}=U();return(f,d)=>(i(),u("div",R,[e("div",W,[c.users.length>0?(i(),u("table",X,[e("thead",Y,[e("tr",null,[e("th",Z,[e("div",ee,l(n(o)("name")),1)]),e("th",te,[e("div",se,l(n(o)("email")),1)]),e("th",ae,[e("div",re,l(n(o)("roles")),1)]),e("th",oe,[e("div",le,l(n(o)("actions")),1)])])]),e("tbody",null,[(i(!0),u(T,null,A(c.users,r=>(i(),u("tr",{key:r.id,class:"text-sm font-semibold border-b-2"},[e("td",ne,[e("div",ie,l(r.name),1)]),e("td",de,[e("div",ce,l(r.email),1)]),e("td",ue,[e("div",me,[(i(!0),u(T,null,A(r.roles,_=>(i(),u("span",{key:_.id,class:"px-1 py-0 bg-slate-100 dark:bg-slate-800 border border-dashed border-gray-400 text-orange-500 dark:text-orange-200 text-xs"},l(_.name),1))),128)),r.roles.length===0?(i(),u("span",pe," — ")):w("",!0)])]),e("td",fe,[e("div",_e,[p(J,{href:f.route("admin.users.edit",r.id)},null,8,["href"]),p(H,{onDelete:_=>f.$emit("delete",r.id)},null,8,["onDelete"])])])]))),128))])])):(i(),u("div",ve,l(n(o)("noData")),1))])]))}},xe={class:"flex justify-center items-center h-fit sm:mr-4 mt-2 mb-2"},ge={for:"sortParam",class:"hidden lg:block sm:mr-2 tracking-wider text-sm font-semibold text-slate-600 dark:text-slate-100"},be=["value"],ye={value:"idDesc"},we={value:"idAsc"},ke={value:"name"},$e={__name:"SortSelect",props:{sortParam:String},emits:["update:sortParam"],setup(c,{emit:m}){const{t:o}=U(),f=m,d=r=>{f("update:sortParam",r.target.value)};return(r,_)=>(i(),u("div",xe,[e("label",ge,l(n(o)("sort")),1),e("select",{id:"sortParam",value:c.sortParam,onChange:d,class:"w-44 px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm"},[e("option",ye,l(n(o)("idDesc")),1),e("option",we,l(n(o)("idAsc")),1),e("option",ke,l(n(o)("name")),1)],40,be)]))}},Ce={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},Pe={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},Se={class:"sm:flex sm:justify-between sm:items-center mb-2"},De=e("svg",{class:"w-4 h-4 fill-current opacity-50 shrink-0",viewBox:"0 0 16 16"},[e("path",{d:"M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z"})],-1),Ue={key:2,class:"flex justify-between items-center flex-col md:flex-row my-1"},qe={__name:"Index",props:["users","usersCount","adminCountUsers","adminSortUsers"],setup(c){const{t:m}=U(),o=I(),f=c,d=v(f.adminCountUsers);V(d,s=>{C.put(route("admin.settings.updateAdminCountUsers"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>o.info(`Показ ${s} элементов на странице.`),onError:t=>o.error(t.value||"Ошибка обновления кол-ва элементов.")})});const r=v(f.adminSortUsers);V(r,s=>{C.put(route("admin.settings.updateAdminSortUsers"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>o.info("Сортировка успешно изменена"),onError:t=>o.error(t.value||"Ошибка обновления сортировки.")})});const _=v(!1),x=v(null),b=v(""),B=(s,t)=>{x.value=s,b.value=t,_.value=!0},y=()=>{_.value=!1,x.value=null,b.value=""},E=()=>{if(x.value===null)return;const s=x.value,t=b.value;C.delete(route("admin.users.destroy",{user:s}),{preserveScroll:!0,preserveState:!1,onSuccess:a=>{y(),o.success(`Пользователь "${t||"ID: "+s}" удален.`)},onError:a=>{y();const j=a.general||a[Object.keys(a)[0]]||"Произошла ошибка при удалении.";o.error(`${j} (Статья: ${t||"ID: "+s})`),console.error("Ошибка удаления:",a)},onFinish:()=>{x.value=null,b.value=""}})},k=v(1),g=v(""),L=s=>r.value==="idAsc"?s.slice().sort((t,a)=>t.id-a.id):r.value==="idDesc"?s.slice().sort((t,a)=>a.id-t.id):s.slice().sort((t,a)=>t[r.value]<a[r.value]?-1:t[r.value]>a[r.value]?1:0),$=P(()=>{let s=f.users;return g.value&&(s=s.filter(t=>t.name.toLowerCase().includes(g.value.toLowerCase())||t.email.toLowerCase().includes(g.value.toLowerCase()))),L(s)}),N=P(()=>{const s=(k.value-1)*d.value;return $.value.slice(s,s+d.value)});return P(()=>Math.ceil($.value.length/d.value)),(s,t)=>(i(),S(M,{title:n(m)("users")},{header:h(()=>[p(F,null,{default:h(()=>[D(l(n(m)("users")),1)]),_:1})]),default:h(()=>[e("div",Ce,[e("div",Pe,[e("div",Se,[p(K,{href:s.route("admin.users.create")},{icon:h(()=>[De]),default:h(()=>[D(" "+l(n(m)("addUser")),1)]),_:1},8,["href"])]),c.usersCount?(i(),S(G,{key:0,modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=a=>g.value=a),placeholder:n(m)("searchByNameOrEmail")},null,8,["modelValue","placeholder"])):w("",!0),c.usersCount?(i(),S(O,{key:1},{default:h(()=>[D(l(c.usersCount),1)]),_:1})):w("",!0),p(he,{users:N.value,onDelete:B},null,8,["users"]),c.usersCount?(i(),u("div",Ue,[p(Q,{"items-per-page":d.value,"onUpdate:itemsPerPage":t[1]||(t[1]=a=>d.value=a)},null,8,["items-per-page"]),p(q,{"current-page":k.value,"items-per-page":d.value,"total-items":$.value.length,"onUpdate:currentPage":t[2]||(t[2]=a=>k.value=a),"onUpdate:itemsPerPage":t[3]||(t[3]=a=>d.value=a)},null,8,["current-page","items-per-page","total-items"]),p($e,{sortParam:r.value,"onUpdate:sortParam":t[4]||(t[4]=a=>r.value=a)},null,8,["sortParam"])])):w("",!0)])]),p(z,{show:_.value,onClose:y,onCancel:y,onConfirm:E,cancelText:n(m)("cancel"),confirmText:n(m)("yesDelete")},null,8,["show","cancelText","confirmText"])]),_:1},8,["title"]))}};export{qe as default};
