import{u as B,m as b,o as h,f as s,t as n,k as a,l as g,C as V,i as m,w as k,F as q,v as R,D as W,y as X,E as x,G as E,e as D,n as T,p as z}from"./vendor-KLnQVH-z.js";import{A as Y}from"./AdminLayout-Dy9mjYMG.js";import{T as Z}from"./TitlePage-Dn5_Db7V.js";import{_ as O,a as ee,b as te}from"./CountTable-BG0LS_kA.js";import{_ as se,a as oe,b as le}from"./SearchInput-BkQ24b52.js";import{_ as ae}from"./ActivityToggle-BMpL71vi.js";import{_ as re}from"./IconEdit-BSiKqtPt.js";import{_ as ie}from"./CloneIconButton-BJi6HPhO.js";import{_ as ne}from"./BulkActionSelect-Bq1UC-pC.js";import{_ as ce}from"./DefaultButton-mNfyXOKI.js";import{a as de}from"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-p73LerAr.js";import"./ScrollButtons-BQ3VHXoa.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-GNuCPEap.js";import"./LocaleSelectOption-DeZNcFHG.js";import"./app-B4TnzLsT.js";import"./auth-image-XbvYdkSi.js";const ue={class:"flex justify-center items-center h-fit sm:mr-4 mt-2 mb-2"},pe={for:"sortParam",class:"hidden lg:block sm:mr-2 tracking-wider text-sm font-semibold text-slate-600 dark:text-slate-100"},ve=["value"],me={value:"idDesc"},fe={value:"idAsc"},he={value:"sort"},_e={value:"title"},ge={value:"locale"},ye={value:"activity"},xe={value:"inactive"},we={__name:"SortSelect",props:{sortParam:String},emits:["update:sortParam"],setup(v,{emit:_}){const{t:l}=B(),w=_,u=i=>{w("update:sortParam",i.target.value)};return(i,$)=>(h(),b("div",ue,[s("label",pe,n(a(l)("sort")),1),s("select",{id:"sortParam",value:v.sortParam,onChange:u,class:"w-36 px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm"},[s("option",me,n(a(l)("idDesc")),1),s("option",fe,n(a(l)("idAsc")),1),s("option",he,n(a(l)("sortNumber")),1),s("option",_e,n(a(l)("title")),1),s("option",ge,n(a(l)("localization")),1),s("option",ye,n(a(l)("active")),1),s("option",xe,n(a(l)("inactive")),1)],40,ve)]))}},Se={class:"bg-white dark:bg-slate-700 shadow-lg rounded-sm border border-slate-200 dark:border-slate-600 relative"},ke={class:"overflow-x-auto"},be={key:0,class:"table-auto w-full text-slate-700 dark:text-slate-100"},$e={class:"text-sm uppercase bg-slate-200 dark:bg-cyan-900 border border-solid border-gray-300 dark:border-gray-700"},Ce={class:"px-2 first:pl-7 last:pr-7 py-3 whitespace-nowrap w-px"},Ae={class:"text-center font-medium"},De={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px"},Te=["title"],Pe=s("svg",{class:"w-6 h-6 fill-current shrink-0",viewBox:"0 0 512 512"},[s("path",{d:"M0 96C0 60.7 28.7 32 64 32l384 0c35.3 0 64 28.7 64 64l0 320c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96zM323.8 202.5c-4.5-6.6-11.9-10.5-19.8-10.5s-15.4 3.9-19.8 10.5l-87 127.6L170.7 297c-4.6-5.7-11.5-9-18.7-9s-14.2 3.3-18.7 9l-64 80c-5.8 7.2-6.9 17.1-2.9 25.4s12.4 13.6 21.6 13.6l96 0 32 0 208 0c8.9 0 17.1-4.9 21.2-12.8s3.6-17.4-1.4-24.7l-120-176zM112 192a48 48 0 1 0 0-96 48 48 0 1 0 0 96z"})],-1),Me=[Pe],Le={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px"},Ee=["title"],ze=s("svg",{class:"w-8 h-8 fill-current shrink-0",viewBox:"0 0 640 512"},[s("path",{d:"M0 128C0 92.7 28.7 64 64 64l192 0 48 0 16 0 256 0c35.3 0 64 28.7 64 64l0 256c0 35.3-28.7 64-64 64l-256 0-16 0-48 0L64 448c-35.3 0-64-28.7-64-64L0 128zm320 0l0 256 256 0 0-256-256 0zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1 .1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1 73.6 0 8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2L179 276l-38 0 19-42.8zM448 164c11 0 20 9 20 20l0 4 44 0 16 0c11 0 20 9 20 20s-9 20-20 20l-2 0-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4c.9 .6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9l-18.9-11.3c-4.5-2.7-8.8-5.5-13.1-8.5c-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8l-12.2-12.2c-7.8-7.8-7.8-20.5 0-28.3s20.5-7.8 28.3 0l14.6 14.6 .5 .5c12.4-13.1 22.5-28.3 29.8-45L448 228l-72 0c-11 0-20-9-20-20s9-20 20-20l52 0 0-4c0-11 9-20 20-20z"})],-1),Ve=[ze],Be={class:"px-2 first:pl-7 last:pr-7 py-3 whitespace-nowrap"},Ie={class:"text-left font-medium"},Ue={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Ne={class:"font-medium text-left"},Fe={class:"px-2 first:pl-7 last:pr-7 py-3 whitespace-nowrap"},He={class:"text-center font-medium"},Ke={class:"px-2 first:pl-7 last:pr-7 py-3 whitespace-nowrap"},Je={class:"text-center font-medium"},Ge={class:"text-sm font-semibold border-b-2 hover:bg-slate-100 dark:hover:bg-cyan-800"},Qe={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},je={class:"text-center text-blue-600 dark:text-blue-200"},qe={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},Re=["innerHTML"],We={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},Xe={class:"text-center uppercase text-orange-500 dark:text-orange-200"},Ye={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},Ze={class:"text-left text-pink-500 dark:text-pink-200"},Oe={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},et={class:"text-left"},tt=["title"],st={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},ot={class:"flex justify-center space-x-2"},lt={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},at={class:"text-center"},rt=["checked","onChange"],it={key:1,class:"p-5 text-center text-slate-700 dark:text-slate-100"},nt={__name:"SectionTable",props:{sections:Array,selectedSections:Array},emits:["toggle-activity","edit","delete","update-sort-order","clone","toggle-select","toggle-all"],setup(v,{emit:_}){const{t:l}=B(),w=v,u=_,i=g([]);V(()=>w.sections,d=>{i.value=JSON.parse(JSON.stringify(d||[]))},{immediate:!0,deep:!0});const $=()=>{const d=i.value.map(y=>y.id);u("update-sort-order",d)},S=d=>{const y=d.target.checked,r=i.value.map(f=>f.id);u("toggle-all",{ids:r,checked:y})};return(d,y)=>(h(),b("div",Se,[s("div",ke,[v.sections.length>0?(h(),b("table",be,[s("thead",$e,[s("tr",null,[s("th",Ce,[s("div",Ae,n(a(l)("id")),1)]),s("th",De,[s("div",{class:"flex justify-center",title:a(l)("icon")},Me,8,Te)]),s("th",Le,[s("div",{class:"flex justify-center",title:a(l)("localization")},Ve,8,Ee)]),s("th",Be,[s("div",Ie,n(a(l)("title")),1)]),s("th",Ue,[s("div",Ne,n(a(l)("rubrics")),1)]),s("th",Fe,[s("div",He,n(a(l)("actions")),1)]),s("th",Ke,[s("div",Je,[s("input",{type:"checkbox",onChange:S},null,32)])])])]),m(a(W),{tag:"tbody",modelValue:i.value,"onUpdate:modelValue":y[0]||(y[0]=r=>i.value=r),onEnd:$,itemKey:"id"},{item:k(({element:r})=>[s("tr",Ge,[s("td",Qe,[s("div",je,n(r.id),1)]),s("td",qe,[s("div",{class:"flex justify-center",innerHTML:r.icon},null,8,Re)]),s("td",We,[s("div",Xe,n(r.locale),1)]),s("td",Ye,[s("div",Ze,n(r.title),1)]),s("td",Oe,[s("div",et,[(h(!0),b(q,null,R(r.rubrics,f=>(h(),b("span",{key:f.id},[s("span",{title:f.title,class:"py-0.5 px-1.5 mr-0.5 badge bg-blue-500 dark:bg-blue-200 rounded-sm text-xs text-slate-100 dark:text-slate-900"},n(f.id),9,tt)]))),128))])]),s("td",st,[s("div",ot,[m(ae,{isActive:r.activity,onToggleActivity:f=>d.$emit("toggle-activity",r),title:r.activity?a(l)("enabled"):a(l)("disabled")},null,8,["isActive","onToggleActivity","title"]),m(ie,{onClone:f=>d.$emit("clone",r)},null,8,["onClone"]),m(re,{href:d.route("admin.sections.edit",r.id)},null,8,["href"]),m(O,{onDelete:f=>d.$emit("delete",r.id)},null,8,["onDelete"])])]),s("td",lt,[s("div",at,[s("input",{type:"checkbox",checked:v.selectedSections.includes(r.id),onChange:f=>d.$emit("toggle-select",r.id)},null,40,rt)])])])]),_:1},8,["modelValue"])])):(h(),b("div",it,n(a(l)("noData")),1))])]))}},ct={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},dt={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},ut={class:"sm:flex sm:justify-between sm:items-center mb-2"},pt=s("svg",{class:"w-4 h-4 fill-current opacity-50 shrink-0",viewBox:"0 0 16 16"},[s("path",{d:"M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z"})],-1),vt={key:2,class:"flex justify-between items-center flex-col md:flex-row my-1"},Lt={__name:"Index",props:["sections","sectionsCount","adminCountSections","adminSortSections"],setup(v){const{t:_}=B(),l=X(),w=v,u=g(w.adminCountSections);V(u,t=>{x.put(route("admin.settings.updateAdminCountSections"),{value:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>l.info(`Показ ${t} элементов на странице.`),onError:e=>l.error(e.value||"Ошибка обновления кол-ва элементов.")})});const i=g(w.adminSortSections);V(i,t=>{x.put(route("admin.settings.updateAdminSortSections"),{value:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>l.info("Сортировка успешно изменена"),onError:e=>l.error(e.value||"Ошибка обновления сортировки.")})});const $=g(!1),S=g(null),d=g(""),y=(t,e)=>{S.value=t,d.value=e,$.value=!0},r=()=>{$.value=!1,S.value=null,d.value=""},f=()=>{if(S.value===null)return;const t=S.value,e=d.value;x.delete(route("admin.sections.destroy",{section:t}),{preserveScroll:!0,preserveState:!1,onSuccess:o=>{r(),l.success(`Секция "${e||"ID: "+t}" удалена.`)},onError:o=>{r();const p=o.general||o[Object.keys(o)[0]]||"Произошла ошибка при удалении.";l.error(`${p} (Секция: ${e||"ID: "+t})`),console.error("Ошибка удаления:",o)},onFinish:()=>{S.value=null,d.value=""}})},U=t=>{const e=!t.activity,o=e?"активирована":"деактивирована";x.put(route("admin.actions.sections.updateActivity",{section:t.id}),{activity:e},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{l.success(`Рубрика "${t.title}" ${o}.`)},onError:p=>{l.error(p.activity||p.general||`Ошибка изменения активности для "${t.title}".`)}})},N=t=>{const e=t==null?void 0:t.id,o=(t==null?void 0:t.title)||`ID: ${e}`;if(typeof e>"u"||e===null){console.error("Не удалось получить ID секции для клонирования",t),l.error("Не удалось определить секцию для клонирования.");return}confirm(`Вы уверены, что хотите клонировать секцию "${o}"?`)&&x.post(route("admin.actions.sections.clone",{section:e}),{},{preserveScroll:!0,preserveState:!1,onSuccess:p=>{l.success(`Секция "${o}" успешно клонирована.`)},onError:p=>{const L=Object.keys(p)[0],j=p[L]||`Ошибка клонирования секции "${o}".`;l.error(j)}})},C=g(1),A=g(""),F=t=>i.value==="idAsc"?t.slice().sort((e,o)=>e.id-o.id):i.value==="idDesc"?t.slice().sort((e,o)=>o.id-e.id):i.value==="activity"?t.filter(e=>e.activity):i.value==="inactive"?t.filter(e=>!e.activity):i.value==="locale"?t.slice().sort((e,o)=>e.locale<o.locale?1:e.locale>o.locale?-1:0):t.slice().sort((e,o)=>e[i.value]<o[i.value]?-1:e[i.value]>o[i.value]?1:0),P=E(()=>{let t=w.sections;return A.value&&(t=t.filter(e=>e.title.toLowerCase().includes(A.value.toLowerCase()))),F(t)}),M=E(()=>{const t=(C.value-1)*u.value;return P.value.slice(t,t+u.value)});E(()=>Math.ceil(P.value.length/u.value));const H=t=>{const e=(C.value-1)*u.value,o=t.map((p,L)=>({id:p,sort:e+L+1}));x.put(route("admin.actions.sections.updateSortBulk"),{sections:o},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{l.success("Порядок рубрик успешно обновлен.")},onError:p=>{console.error("Ошибка обновления сортировки:",p),l.error(p.general||p.sections||"Не удалось обновить порядок рубрик."),x.reload({only:["sections"],preserveScroll:!0})}})},c=g([]),K=({ids:t,checked:e})=>{e?c.value=[...new Set([...c.value,...t])]:c.value=c.value.filter(o=>!t.includes(o))},J=t=>{const e=c.value.indexOf(t);e>-1?c.value.splice(e,1):c.value.push(t)},I=t=>{if(!c.value.length){l.warning("Выберите рубрики для активации/деактивации рубрик");return}de.put(route("admin.actions.sections.bulkUpdateActivity"),{ids:c.value,activity:t}).then(()=>{l.success("Активность массово обновлена");const e=[...c.value];c.value=[],M.value.forEach(o=>{e.includes(o.id)&&(o.activity=t)})}).catch(()=>{l.error("Не удалось обновить активность")})},G=()=>{if(c.value.length===0){l.warning("Выберите хотя бы одну секцию для удаления.");return}confirm("Вы уверены, что хотите их удалить ?")&&x.delete(route("admin.actions.sections.bulkDestroy"),{data:{ids:c.value},preserveScroll:!0,preserveState:!1,onSuccess:t=>{c.value=[],l.success("Массовое удаление секций успешно завершено.")},onError:t=>{console.error("Ошибка массового удаления:",t);const e=Object.keys(t)[0],o=t[e]||"Произошла ошибка при удалении секций.";l.error(o)}})},Q=t=>{const e=t.target.value;e==="selectAll"?c.value=M.value.map(o=>o.id):e==="deselectAll"?c.value=[]:e==="activate"?I(!0):e==="deactivate"?I(!1):e==="delete"&&G(),t.target.value=""};return(t,e)=>(h(),D(Y,{title:a(_)("sections")},{header:k(()=>[m(Z,null,{default:k(()=>[z(n(a(_)("sections")),1)]),_:1})]),default:k(()=>[s("div",ct,[s("div",dt,[s("div",ut,[m(ce,{href:t.route("admin.sections.create")},{icon:k(()=>[pt]),default:k(()=>[z(" "+n(a(_)("addSection")),1)]),_:1},8,["href"]),v.sectionsCount?(h(),D(ne,{key:0,onChange:Q})):T("",!0)]),v.sectionsCount?(h(),D(se,{key:0,modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=o=>A.value=o),placeholder:a(_)("searchByName")},null,8,["modelValue","placeholder"])):T("",!0),v.sectionsCount?(h(),D(ee,{key:1},{default:k(()=>[z(n(v.sectionsCount),1)]),_:1})):T("",!0),m(nt,{sections:M.value,"selected-sections":c.value,onToggleActivity:U,onDelete:y,onClone:N,onUpdateSortOrder:H,onToggleSelect:J,onToggleAll:K},null,8,["sections","selected-sections"]),v.sectionsCount?(h(),b("div",vt,[m(oe,{"items-per-page":u.value,"onUpdate:itemsPerPage":e[1]||(e[1]=o=>u.value=o)},null,8,["items-per-page"]),m(le,{"current-page":C.value,"items-per-page":u.value,"total-items":P.value.length,"onUpdate:currentPage":e[2]||(e[2]=o=>C.value=o),"onUpdate:itemsPerPage":e[3]||(e[3]=o=>u.value=o)},null,8,["current-page","items-per-page","total-items"]),m(we,{sortParam:i.value,"onUpdate:sortParam":e[4]||(e[4]=o=>i.value=o)},null,8,["sortParam"])])):T("",!0)])]),m(te,{show:$.value,onClose:r,onCancel:r,onConfirm:f,cancelText:a(_)("cancel"),confirmText:a(_)("yesDelete")},null,8,["show","cancelText","confirmText"])]),_:1},8,["title"]))}};export{Lt as default};
