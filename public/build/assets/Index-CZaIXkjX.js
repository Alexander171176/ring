import{u as T,m,o as d,f as e,t as a,k as l,F as K,v as W,n as h,i as p,z as X,a5 as Y,e as M,w as k,I as j,ae as L,L as E,af as ee,T as te,l as b,C as N,G as H,p as O}from"./vendor-DbgL49-7.js";import{A as se}from"./AdminLayout-Dj1iN9F0.js";import{T as oe}from"./TitlePage-BlzfwSge.js";import{_ as ae,a as le,b as ne}from"./CountTable-Bzn8CoCB.js";import{_ as ie,a as re,b as ce}from"./SearchInput-GlOr1HhJ.js";import{_ as de}from"./BulkActionSelect-bL4ySmId.js";import{_ as me}from"./ActivityToggle--Ebjgl3Z.js";import{a as A}from"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-286Uv_vn.js";import"./ScrollButtons-j_yPOiLw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-ClfdI87a.js";import"./LocaleSelectOption-T0uB1QLB.js";import"./app-kw_2sf2l.js";import"./auth-image-XbvYdkSi.js";const ue={class:"flex justify-center items-center h-fit sm:mr-4 mt-2 mb-2"},ve={for:"sortParam",class:"hidden lg:block sm:mr-2 tracking-wider text-sm font-semibold text-slate-600 dark:text-slate-100"},he=["value"],pe={value:"idDesc"},fe={value:"idAsc"},xe={value:"activity"},_e={value:"inactive"},ye={value:"status"},ge={value:"instatus"},be={value:"user"},we={__name:"SortSelect",props:{sortParam:String},emits:["update:sortParam"],setup(i,{emit:f}){const{t:o}=T(),_=f,u=r=>{_("update:sortParam",r.target.value)};return(r,v)=>(d(),m("div",ue,[e("label",ve,a(l(o)("sort")),1),e("select",{id:"sortParam",value:i.sortParam,onChange:u,class:"w-auto px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm"},[e("option",pe,a(l(o)("idDesc")),1),e("option",fe,a(l(o)("idAsc")),1),e("option",xe,a(l(o)("active")),1),e("option",_e,a(l(o)("inactive")),1),e("option",ye,a(l(o)("passedModeration")),1),e("option",ge,a(l(o)("notPassModeration")),1),e("option",be,a(l(o)("users")),1)],40,he)]))}},ke={class:"bg-white dark:bg-slate-700 shadow-lg rounded-sm border border-slate-200 dark:border-slate-600 relative"},$e={class:"overflow-x-auto"},Ce={key:0,class:"table-auto w-full text-slate-700 dark:text-slate-100"},Ae={class:"text-sm uppercase bg-slate-200 dark:bg-cyan-900 border border-solid border-gray-300 dark:border-gray-700"},Me={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px"},Pe={class:"font-medium text-center"},De={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Te={class:"font-medium text-left"},Ve={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Se={class:"font-medium text-left"},ze={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Be={class:"font-medium text-end"},je={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Le={class:"font-semibold text-center"},Ee={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},He={class:"text-center"},Ue={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Ne={class:"text-left text-yellow-500 dark:text-rose-200"},Oe={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Ze={class:"text-left text-blue-600 dark:text-violet-200"},Fe={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Ie={class:"flex justify-end space-x-2"},Ge=["onClick","title"],Qe=e("svg",{class:"w-4 h-4 shrink-0 fill-current text-teal-500 mx-1",viewBox:"0 0 16 16"},[e("path",{d:"M14.14 9.585h-.002a2.5 2.5 0 0 1-2 4.547 6.91 6.91 0 0 1-6.9 1.165 4.436 4.436 0 0 0 1.343-1.682c.365.087.738.132 1.113.135a4.906 4.906 0 0 0 2.924-.971 2.5 2.5 0 0 1 3.522-3.194Zm-4.015-7.397a7.023 7.023 0 0 1 4.47 5.396 4.5 4.5 0 0 0-1.7-.334c-.15.002-.299.012-.447.03a5.027 5.027 0 0 0-2.723-3.078 2.5 2.5 0 1 1 .4-2.014ZM4.663 10.5a2.5 2.5 0 1 1-3.859-.584 6.888 6.888 0 0 1-.11-1.166c0-2.095.94-4.08 2.56-5.407.093.727.364 1.419.788 2.016A4.97 4.97 0 0 0 2.694 8.75c.003.173.015.345.037.516A2.49 2.49 0 0 1 4.663 10.5Z"})],-1),Re=[Qe],qe=["onClick","title"],Je=e("svg",{class:"w-4 h-4 shrink-0 fill-current text-blue-500 mx-1",viewBox:"0 0 16 16"},[e("path",{d:"M5 9h11v2H5V9zM0 9h3v2H0V9zm5 4h6v2H5v-2zm-5 0h3v2H0v-2zm5-8h7v2H5V5zM0 5h3v2H0V5zm5-4h11v2H5V1zM0 1h3v2H0V1z"})],-1),Ke=[Je],We={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Xe={class:"text-center"},Ye=["checked","onChange"],et={key:1,class:"p-5 text-center text-slate-700 dark:text-slate-100"},tt={__name:"CommentTable",props:{comments:Array,selectedComments:Array},emits:["toggle-activity","edit","delete","toggle-select","view-details","approve-comment"],setup(i,{emit:f}){const{t:o}=T(),_=i,u=f,r=v=>{const y=v.target.checked;_.comments.forEach(c=>{(y&&!_.selectedComments.includes(c.id)||!y&&_.selectedComments.includes(c.id))&&u("toggle-select",c.id)})};return(v,y)=>(d(),m("div",ke,[e("div",$e,[i.comments.length>0?(d(),m("table",Ce,[e("thead",Ae,[e("tr",null,[e("th",Me,[e("div",Pe,a(l(o)("id")),1)]),e("th",De,[e("div",Te,a(l(o)("userName")),1)]),e("th",Ve,[e("div",Se,a(l(o)("comment")),1)]),e("th",ze,[e("div",Be,a(l(o)("actions")),1)]),e("th",je,[e("div",Le,[e("input",{type:"checkbox",onChange:r},null,32)])])])]),e("tbody",null,[(d(!0),m(K,null,W(i.comments,c=>(d(),m("tr",{key:c.id,class:"text-sm font-semibold border-b-2 hover:bg-slate-100 dark:hover:bg-cyan-800"},[e("td",Ee,[e("div",He,a(c.id),1)]),e("td",Ue,[e("div",Ne,a(c.user.name),1)]),e("td",Oe,[e("div",Ze,a(c.content),1)]),e("td",Fe,[e("div",Ie,[c.status?h("",!0):(d(),m("button",{key:0,onClick:g=>v.$emit("approve-comment",c.id),title:l(o)("approve"),class:"flex items-center py-1 px-1 rounded border border-slate-300 hover:border-teal-500 dark:border-teal-300 dark:hover:border-teal-100"},Re,8,Ge)),e("button",{onClick:g=>v.$emit("view-details",c),title:l(o)("view"),class:"flex items-center py-1 px-1 rounded border border-slate-300 hover:border-blue-500 dark:border-blue-300 dark:hover:border-blue-100"},Ke,8,qe),p(me,{isActive:c.activity,onToggleActivity:g=>v.$emit("toggle-activity",c),title:c.activity?l(o)("enabled"):l(o)("disabled")},null,8,["isActive","onToggleActivity","title"]),p(ae,{onClick:g=>v.$emit("delete",c.id)},null,8,["onClick"])])]),e("td",We,[e("div",Xe,[e("input",{type:"checkbox",checked:i.selectedComments.includes(c.id),onChange:g=>v.$emit("toggle-select",c.id)},null,40,Ye)])])]))),128))])])):(d(),m("div",et,a(l(o)("noData")),1))])]))}},st={class:"fixed inset-0 z-50 flex items-center justify-center overflow-y-auto","scroll-region":""},ot=e("div",{class:"absolute inset-0 bg-slate-800 opacity-25"},null,-1),at=[ot],lt={class:"bg-slate-100 dark:bg-slate-800 rounded-lg shadow-xl transform transition-all max-w-lg w-full max-h-full sm:w-full sm:mx-auto relative overflow-y-auto"},nt=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-gray-400 hover:text-red-400 dark:text-gray-300 dark:hover:text-red-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),it=[nt],rt={class:"px-3 py-1"},ct={class:"text-center text-md font-semibold text-gray-900 dark:text-gray-100 pb-1 border-dashed border-b border-slate-400"},dt={key:0,class:"my-2"},mt={class:"font-semibold text-sm text-violet-700 dark:text-rose-300"},ut={class:"font-semibold italic text-sm text-gray-700 dark:text-gray-300"},vt={key:1,class:"my-2"},ht={class:"font-semibold text-sm text-violet-700 dark:text-rose-300"},pt={class:"font-semibold italic text-sm text-gray-700 dark:text-gray-300"},ft={key:2,class:"my-2"},xt={class:"font-semibold text-sm text-violet-700 dark:text-rose-300"},_t={class:"font-semibold italic text-sm text-gray-700 dark:text-gray-300"},yt={key:3,class:"my-2"},gt={class:"font-semibold text-sm text-violet-700 dark:text-rose-300"},bt={class:"font-semibold italic text-sm text-gray-700 dark:text-gray-300"},wt={key:4,class:"my-2"},kt={class:"font-semibold text-sm text-violet-700 dark:text-rose-300"},$t={class:"font-semibold italic text-sm text-gray-700 dark:text-gray-300"},Ct={key:5,class:"my-2"},At={class:"font-semibold text-sm text-violet-700 dark:text-rose-300"},Mt={class:"font-semibold italic text-sm text-gray-700 dark:text-gray-300"},Pt={key:6,class:"my-2"},Dt={class:"font-semibold text-sm text-violet-700 dark:text-rose-300"},Tt={class:"font-semibold italic text-sm text-gray-700 dark:text-gray-300"},Vt={key:7,class:"my-2"},St={class:"font-semibold text-sm text-violet-700 dark:text-rose-300"},zt={class:"font-semibold italic text-sm text-gray-700 dark:text-gray-300"},Bt={class:"my-1 sm:flex sm:flex-row-reverse space-x-2"},jt=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-gray-100",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),Lt={class:"ml-2"},Et={__name:"CommentDetailsModal",props:{show:Boolean,comment:Object},emits:["close"],setup(i,{emit:f}){const{t:o}=T(),_=i,u=f,r=()=>{u("close")},v=y=>{y.key==="Escape"&&_.show&&r()};return X(()=>document.addEventListener("keydown",v)),Y(()=>document.removeEventListener("keydown",v)),(y,c)=>(d(),M(ee,{to:"body"},[p(L,{"leave-active-class":"duration-200"},{default:k(()=>[j(e("div",st,[p(L,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:k(()=>[j(e("div",{class:"fixed inset-0 transform transition-all",onClick:r},at,512),[[E,i.show]])]),_:1}),p(L,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to-class":"opacity-100 translate-y-0 sm:scale-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100 translate-y-0 sm:scale-100","leave-to-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:k(()=>{var g,$,C,P;return[j(e("div",lt,[e("button",{onClick:r,class:"absolute top-0 right-1 m-1"},it),e("div",rt,[e("h3",ct,a(l(o)("commentDetails"))+" - "+a(l(o)("id"))+": "+a((g=i.comment)==null?void 0:g.id),1),($=i.comment)!=null&&$.user?(d(),m("div",dt,[e("span",mt,a(l(o)("userCommented")),1),e("p",ut,a(i.comment.user.name),1)])):h("",!0),(C=i.comment)!=null&&C.article?(d(),m("div",vt,[e("span",ht,a(l(o)("commentedArticle")),1),e("p",pt,a(i.comment.article.title),1)])):h("",!0),(P=i.comment)!=null&&P.rubric?(d(),m("div",ft,[e("span",xt,a(l(o)("commentedRubric")),1),e("p",_t,a(i.comment.rubric.title),1)])):h("",!0),i.comment?(d(),m("div",yt,[e("span",gt,a(l(o)("comment"))+": ",1),e("p",bt,a(i.comment.content),1)])):h("",!0),i.comment?(d(),m("div",wt,[e("span",kt,a(l(o)("status"))+": ",1),e("p",$t,a(i.comment.status?l(o)("moderationPassed"):l(o)("underModeration")),1)])):h("",!0),i.comment?(d(),m("div",Ct,[e("span",At,a(l(o)("activity"))+": ",1),e("p",Mt,a(i.comment.activity?l(o)("active"):l(o)("inactive")),1)])):h("",!0),i.comment?(d(),m("div",Pt,[e("span",Dt,a(l(o)("createdAt"))+": ",1),e("p",Tt,a(i.comment.created_at),1)])):h("",!0),i.comment?(d(),m("div",Vt,[e("span",St,a(l(o)("updatedAt"))+": ",1),e("p",zt,a(i.comment.updated_at),1)])):h("",!0),e("div",Bt,[e("button",{type:"button",class:"flex justify-center items-center float-right rounded-md border border-transparent shadow-sm px-3 py-0 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:w-auto sm:text-sm",onClick:r},[jt,e("span",Lt,a(l(o)("close")),1)])])])],512),[[E,i.show]])]}),_:1})],512),[[E,i.show]])]),_:1})]))}},Ht={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},Ut={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},Nt={class:"sm:flex sm:justify-end sm:items-center mb-2"},Ot={key:2,class:"flex justify-between items-center flex-col md:flex-row my-1"},os={__name:"Index",props:["comments","commentsCount","adminCountComments","adminSortComments"],setup(i){const{t:f}=T(),o=i,_=te({}),u=b(o.adminCountComments);N(u,s=>{A.put(route("settings.updateAdminCountComments"),{value:s.toString()}).then(t=>{}).catch(t=>{console.error("Ошибка обновления настройки:",t.response.data)})});const r=b(o.adminSortComments);N(r,s=>{A.put(route("settings.updateAdminSortComments"),{value:s}).then(t=>{}).catch(t=>{console.error("Ошибка обновления сортировки:",t.response.data)})});const v=b(!1),y=b(null),c=s=>{y.value=s,v.value=!0},g=()=>{v.value=!1},$=b(!1),C=b(null),P=s=>{C.value=s,$.value=!0},V=()=>{$.value=!1},Z=()=>{C.value!==null&&_.delete(route("comments.destroy",C.value),{onSuccess:()=>V()})},F=s=>{const t=!s.activity;A.put(route("comments.updateActivity",s.id),{activity:t}).then(n=>{s.activity=t,n.data.reload&&window.location.reload()}).catch(n=>{var w;console.error(((w=n.response)==null?void 0:w.data)||n.message)})},S=b(1),D=b(""),I=s=>r.value==="idAsc"?s.slice().sort((t,n)=>t.id-n.id):r.value==="idDesc"?s.slice().sort((t,n)=>n.id-t.id):r.value==="activity"?s.filter(t=>t.activity):r.value==="inactive"?s.filter(t=>!t.activity):r.value==="status"?s.filter(t=>t.status):r.value==="instatus"?s.filter(t=>!t.status):r.value==="user"?s.slice().sort((t,n)=>t.user.name.localeCompare(n.user.name)):s.slice().sort((t,n)=>t[r.value]<n[r.value]?-1:t[r.value]>n[r.value]?1:0),z=H(()=>{let s=o.comments;return D.value&&(s=s.filter(t=>t.content.toLowerCase().includes(D.value.toLowerCase()))),I(s)}),B=H(()=>{const s=(S.value-1)*u.value;return z.value.slice(s,s+u.value)});H(()=>Math.ceil(z.value.length/u.value));const x=b([]),G=s=>{const t=s.target.checked;x.value=t?B.value.map(n=>n.id):[]},Q=s=>{const t=x.value.indexOf(s);t>-1?x.value.splice(t,1):x.value.push(s)},U=s=>{x.value.forEach(t=>{A.put(route("comments.updateActivity",t),{activity:s}).then(n=>{n.data.reload&&window.location.reload()}).catch(n=>{var w;console.error(((w=n.response)==null?void 0:w.data)||n.message)})})},R=()=>{A.delete(route("comments.bulkDestroy"),{data:{ids:x.value}}).then(s=>{x.value=[],s.data.reload&&window.location.reload()}).catch(s=>{console.error(s.response.data)})},q=s=>{const t=s.target.value;t==="selectAll"?B.value.forEach(n=>{x.value.includes(n.id)||x.value.push(n.id)}):t==="deselectAll"?x.value=[]:t==="activate"?U(!0):t==="deactivate"?U(!1):t==="delete"&&R(),s.target.value=""},J=s=>{A.put(route("comments.approve",s)).then(t=>{const n=o.comments.find(w=>w.id===s);n&&(n.status=!0)}).catch(t=>{console.error(t)})};return(s,t)=>(d(),M(se,{title:l(f)("comments")},{header:k(()=>[p(oe,null,{default:k(()=>[O(a(l(f)("comments")),1)]),_:1})]),default:k(()=>[e("div",Ht,[e("div",Ut,[e("div",Nt,[i.commentsCount?(d(),M(de,{key:0,onChange:q})):h("",!0)]),i.commentsCount?(d(),M(ie,{key:0,modelValue:D.value,"onUpdate:modelValue":t[0]||(t[0]=n=>D.value=n),placeholder:l(f)("search")},null,8,["modelValue","placeholder"])):h("",!0),i.commentsCount?(d(),M(le,{key:1},{default:k(()=>[O(a(i.commentsCount),1)]),_:1})):h("",!0),p(tt,{comments:B.value,"selected-comments":x.value,onToggleActivity:F,onDelete:P,onToggleSelect:Q,onToggleAll:G,onViewDetails:c,onApproveComment:J},null,8,["comments","selected-comments"]),p(Et,{show:v.value,comment:y.value,onClose:g},null,8,["show","comment"]),i.commentsCount?(d(),m("div",Ot,[p(re,{"items-per-page":u.value,"onUpdate:itemsPerPage":t[1]||(t[1]=n=>u.value=n)},null,8,["items-per-page"]),p(ce,{"current-page":S.value,"items-per-page":u.value,"total-items":z.value.length,"onUpdate:currentPage":t[2]||(t[2]=n=>S.value=n),"onUpdate:itemsPerPage":t[3]||(t[3]=n=>u.value=n)},null,8,["current-page","items-per-page","total-items"]),p(we,{sortParam:r.value,"onUpdate:sortParam":t[4]||(t[4]=n=>r.value=n)},null,8,["sortParam"])])):h("",!0)])]),p(ne,{show:$.value,onClose:V,onCancel:V,onConfirm:Z,cancelText:l(f)("cancel"),confirmText:l(f)("yesDelete")},null,8,["show","cancelText","confirmText"])]),_:1},8,["title"]))}};export{os as default};
