import{u as T,m as u,o as n,f as t,t as i,k as l,F as R,v as A,n as w,i as p,y as M,l as _,C as V,E as P,G as C,e as S,w as h,p as D}from"./vendor-KLnQVH-z.js";import{A as U}from"./AdminLayout-KvkKhlAB.js";import{T as F}from"./TitlePage-Dn5_Db7V.js";import{_ as L,a as H,b as z}from"./CountTable-BG0LS_kA.js";import{_ as G,a as O,b as Q}from"./SearchInput-BkQ24b52.js";import{_ as q}from"./IconEdit-BSiKqtPt.js";import{_ as J}from"./DefaultButton-mNfyXOKI.js";import"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-p73LerAr.js";import"./ScrollButtons-BQ3VHXoa.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-GNuCPEap.js";import"./LocaleSelectOption-4GkEdIIT.js";import"./app-CG-PXnx1.js";import"./auth-image-XbvYdkSi.js";const K={class:"bg-white dark:bg-slate-700 shadow-lg rounded-sm border border-slate-200 dark:border-slate-600 relative"},W={class:"overflow-x-auto"},X={key:0,class:"table-auto w-full text-slate-700 dark:text-slate-100"},Y={class:"text-sm font-semibold uppercase bg-slate-200 dark:bg-cyan-900 border border-solid border-gray-300 dark:border-gray-700"},Z={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},ee={class:"font-semibold text-left"},te={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},se={class:"font-semibold text-left"},ae={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},oe={class:"font-semibold text-end"},re={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},le={class:"text-left text-teal-600 dark:text-violet-200"},ne={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},ie={class:"flex flex-wrap gap-1"},de={key:0,class:"text-xs italic text-gray-500"},ce={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},ue={class:"flex justify-end space-x-2"},me={key:1,class:"p-5 text-center text-slate-700 dark:text-slate-100"},pe={__name:"RoleTable",props:{roles:Array},emits:["edit","delete"],setup(c,{emit:m}){const{t:r}=T();return(f,d)=>(n(),u("div",K,[t("div",W,[c.roles.length>0?(n(),u("table",X,[t("thead",Y,[t("tr",null,[t("th",Z,[t("div",ee,i(l(r)("name")),1)]),t("th",te,[t("div",se,i(l(r)("permissions")),1)]),t("th",ae,[t("div",oe,i(l(r)("actions")),1)])])]),t("tbody",null,[(n(!0),u(R,null,A(c.roles,o=>(n(),u("tr",{key:o.id,class:"text-sm font-semibold border-b-2 hover:bg-slate-100 dark:hover:bg-cyan-800"},[t("td",re,[t("div",le,i(o.name),1)]),t("td",ne,[t("div",ie,[(n(!0),u(R,null,A(o.permissions,v=>(n(),u("span",{key:v.id,class:"px-1 py-0 bg-slate-100 dark:bg-slate-800 border border-dashed border-gray-400 text-orange-500 dark:text-orange-200 text-xs"},i(v.name),1))),128)),o.permissions.length===0?(n(),u("span",de," — ")):w("",!0)])]),t("td",ce,[t("div",ue,[p(q,{href:f.route("admin.roles.edit",o.id)},null,8,["href"]),p(L,{onDelete:v=>f.$emit("delete",o.id)},null,8,["onDelete"])])])]))),128))])])):(n(),u("div",me,i(l(r)("noData")),1))])]))}},fe={class:"flex justify-center items-center h-fit sm:mr-4 mt-2 mb-2"},ve={for:"sortParam",class:"hidden lg:block sm:mr-2 tracking-wider text-sm font-semibold text-slate-600 dark:text-slate-100"},_e=["value"],he={value:"idDesc"},ge={value:"idAsc"},xe={value:"name"},be={__name:"SortSelect",props:{sortParam:String},emits:["update:sortParam"],setup(c,{emit:m}){const{t:r}=T(),f=m,d=o=>{f("update:sortParam",o.target.value)};return(o,v)=>(n(),u("div",fe,[t("label",ve,i(l(r)("sort")),1),t("select",{id:"sortParam",value:c.sortParam,onChange:d,class:"w-44 px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm"},[t("option",he,i(l(r)("idDesc")),1),t("option",ge,i(l(r)("idAsc")),1),t("option",xe,i(l(r)("name")),1)],40,_e)]))}},ye={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},we={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},ke={class:"sm:flex sm:justify-between sm:items-center mb-2"},$e=t("svg",{class:"w-4 h-4 fill-current opacity-50 shrink-0",viewBox:"0 0 16 16"},[t("path",{d:"M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z"})],-1),Pe={key:2,class:"flex justify-between items-center flex-col md:flex-row my-1"},Le={__name:"Index",props:["roles","rolesCount","adminCountRoles","adminSortRoles"],setup(c){const{t:m}=T(),r=M(),f=c,d=_(f.adminCountRoles);V(d,s=>{P.put(route("admin.settings.updateAdminCountRoles"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>r.info(`Показ ${s} элементов на странице.`),onError:e=>r.error(e.value||"Ошибка обновления кол-ва элементов.")})});const o=_(f.adminSortRoles);V(o,s=>{P.put(route("admin.settings.updateAdminSortRoles"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>r.info("Сортировка успешно изменена"),onError:e=>r.error(e.value||"Ошибка обновления сортировки.")})});const v=_(!1),g=_(null),x=_(""),B=(s,e)=>{g.value=s,x.value=e,v.value=!0},b=()=>{v.value=!1,g.value=null,x.value=""},N=()=>{if(g.value===null)return;const s=g.value,e=x.value;P.delete(route("admin.roles.destroy",{role:s}),{preserveScroll:!0,preserveState:!1,onSuccess:a=>{b(),r.success(`Роль "${e||"ID: "+s}" удалена.`)},onError:a=>{b();const I=a.general||a[Object.keys(a)[0]]||"Произошла ошибка при удалении.";r.error(`${I} (Роль: ${e||"ID: "+s})`),console.error("Ошибка удаления:",a)},onFinish:()=>{g.value=null,x.value=""}})},k=_(1),y=_(""),j=s=>o.value==="idAsc"?s.slice().sort((e,a)=>e.id-a.id):o.value==="idDesc"?s.slice().sort((e,a)=>a.id-e.id):s.slice().sort((e,a)=>e[o.value]<a[o.value]?-1:e[o.value]>a[o.value]?1:0),$=C(()=>{let s=f.roles;return y.value&&(s=s.filter(e=>e.name.toLowerCase().includes(y.value.toLowerCase()))),j(s)}),E=C(()=>{const s=(k.value-1)*d.value;return $.value.slice(s,s+d.value)});return C(()=>Math.ceil($.value.length/d.value)),(s,e)=>(n(),S(U,{title:l(m)("roles")},{header:h(()=>[p(F,null,{default:h(()=>[D(i(l(m)("roles")),1)]),_:1})]),default:h(()=>[t("div",ye,[t("div",we,[t("div",ke,[p(J,{href:s.route("admin.roles.create")},{icon:h(()=>[$e]),default:h(()=>[D(" "+i(l(m)("addRole")),1)]),_:1},8,["href"])]),c.rolesCount?(n(),S(G,{key:0,modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=a=>y.value=a),placeholder:l(m)("searchByName")},null,8,["modelValue","placeholder"])):w("",!0),c.rolesCount?(n(),S(H,{key:1},{default:h(()=>[D(i(c.rolesCount),1)]),_:1})):w("",!0),p(pe,{roles:E.value,onDelete:B},null,8,["roles"]),c.rolesCount?(n(),u("div",Pe,[p(O,{"items-per-page":d.value,"onUpdate:itemsPerPage":e[1]||(e[1]=a=>d.value=a)},null,8,["items-per-page"]),p(Q,{"current-page":k.value,"items-per-page":d.value,"total-items":$.value.length,"onUpdate:currentPage":e[2]||(e[2]=a=>k.value=a),"onUpdate:itemsPerPage":e[3]||(e[3]=a=>d.value=a)},null,8,["current-page","items-per-page","total-items"]),p(be,{sortParam:o.value,"onUpdate:sortParam":e[4]||(e[4]=a=>o.value=a)},null,8,["sortParam"])])):w("",!0)])]),p(z,{show:v.value,onClose:b,onCancel:b,onConfirm:N,cancelText:l(m)("cancel"),confirmText:l(m)("yesDelete")},null,8,["show","cancelText","confirmText"])]),_:1},8,["title"]))}};export{Le as default};
