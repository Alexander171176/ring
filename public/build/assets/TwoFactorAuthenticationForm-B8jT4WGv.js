import{r as g,a as D,x as l,P as t,H as u,k as c,Q,D as s,I as i,J as o,u as e,y as b,aG as N,n as G,b as U,w as z,A as x,G as p,F as J,N as j}from"./vue-DrbZvlgE.js";import{u as H,Q as O,T as W,F as B}from"./app-Bp8GUED0.js";import{_ as X}from"./Modal-DaWd6ry5.js";import{_ as Y}from"./DialogModal-6fqBEian.js";import{_ as L,a as q}from"./TextInput-CTDGYsrk.js";import{_ as A}from"./PrimaryButton-Bhj0kBWG.js";import{_ as T}from"./SecondaryButton-yS4FVESO.js";import{_ as Z}from"./DangerButton-B_jKqh0l.js";import{_ as ee}from"./InputLabel-2ZtwOBR0.js";import"./vendor-CGnu3J7H.js";import"./SectionTitle-eGvQqSRO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"mt-4"},k={__name:"ConfirmsPassword",props:{title:{type:String},content:{type:String},button:{type:String}},emits:["confirmed"],setup(E,{emit:S}){const{t:y}=H(),m=S,r=g(!1),a=D({password:"",error:"",processing:!1}),v=g(null),h=()=>{axios.get(route("password.confirmation")).then(d=>{d.data.confirmed?m("confirmed"):(r.value=!0,setTimeout(()=>v.value.focus(),250))})},w=()=>{a.processing=!0,axios.post(route("password.confirm"),{password:a.password}).then(()=>{a.processing=!1,f(),G().then(()=>m("confirmed"))}).catch(d=>{a.processing=!1,a.error=d.response.data.errors.password[0],v.value.focus()})},f=()=>{r.value=!1,a.password="",a.error=""};return(d,C)=>(t(),l("span",null,[u("span",{onClick:h},[Q(d.$slots,"default")]),c(Y,{show:r.value,onClose:f},{title:s(()=>[i(o(e(y)("confirmPassword")),1)]),content:s(()=>[i(o(e(y)("securityMessage"))+" ",1),u("div",te,[c(L,{ref_key:"passwordInput",ref:v,modelValue:a.password,"onUpdate:modelValue":C[0]||(C[0]=$=>a.password=$),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:N(w,["enter"])},null,8,["modelValue"]),c(q,{message:a.error,class:"mt-2"},null,8,["message"])])]),footer:s(()=>[c(T,{onClick:f},{default:s(()=>[i(o(e(y)("cancel")),1)]),_:1}),c(A,{class:b(["ms-3",{"opacity-25":a.processing}]),disabled:a.processing,onClick:w},{default:s(()=>[i(o(e(y)("confirm")),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},oe={key:0,class:"text-xl font-medium text-orange-400 dark:text-orange-200"},se={key:1,class:"text-xl font-medium text-orange-400 dark:text-orange-200"},ae={key:2,class:"text-xl font-medium text-orange-400 dark:text-orange-200"},re={class:"mt-3 max-w-xl font-semibold text-lg text-indigo-900 dark:text-sky-200"},ne={key:3},le={key:0},ce={class:"mt-4 max-w-xl font-semibold text-lg text-indigo-900 dark:text-sky-200"},ie={key:0,class:"font-semibold"},de={key:1},ue=["innerHTML"],me={key:0,class:"mt-4 max-w-xl text-lg text-orange-500"},fe={class:"font-semibold"},pe=["innerHTML"],_e={key:1,class:"mt-4"},ve={key:1},we={class:"mt-4 max-w-xl text-lg text-indigo-900 dark:text-sky-200"},ge={class:"font-semibold"},ye={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-lg bg-gray-100 rounded-lg"},he={class:"mt-5"},xe={key:0},ke={key:1},Be={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(E){const S=E,y=O(),m=g(!1),r=g(!1),a=g(!1),v=g(null),h=g(null),w=g([]),f=W({code:""}),d=U(()=>{var _;return!m.value&&((_=y.props.auth.user)==null?void 0:_.two_factor_enabled)});z(d,()=>{d.value||(f.reset(),f.clearErrors())});const C=()=>{m.value=!0,B.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([$(),I(),V()]),onFinish:()=>{m.value=!1,r.value=S.requiresConfirmation}})},$=()=>axios.get(route("two-factor.qr-code")).then(_=>{v.value=_.data.svg}),I=()=>axios.get(route("two-factor.secret-key")).then(_=>{h.value=_.data.secretKey}),V=()=>axios.get(route("two-factor.recovery-codes")).then(_=>{w.value=_.data}),M=()=>{f.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{r.value=!1,v.value=null,h.value=null}})},R=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>V())},P=()=>{a.value=!0,B.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{a.value=!1,r.value=!1}})},{t:n}=H();return(_,K)=>(t(),x(X,null,{title:s(()=>[i(o(e(n)("twoFactorAuthentication")),1)]),description:s(()=>[i(o(e(n)("twoFactorAuthenticationDescription")),1)]),content:s(()=>[d.value&&!r.value?(t(),l("h3",oe,o(e(n)("twoFactorEnabled")),1)):d.value&&r.value?(t(),l("h3",se,o(e(n)("completeTwoFactorSetup")),1)):(t(),l("h3",ae,o(e(n)("twoFactorNotEnabled")),1)),u("div",re,[u("p",null,o(e(n)("twoFactorExplanation")),1)]),d.value?(t(),l("div",ne,[v.value?(t(),l("div",le,[u("div",ce,[r.value?(t(),l("p",ie,o(e(n)("completeTwoFactorEnable")),1)):(t(),l("p",de,o(e(n)("twoFactorEnabledMessage")),1))]),u("div",{class:"mt-4 p-2 inline-block bg-white",innerHTML:v.value},null,8,ue),h.value?(t(),l("div",me,[u("p",fe,[i(o(e(n)("setupKey"))+": ",1),u("span",{innerHTML:h.value},null,8,pe)])])):p("",!0),r.value?(t(),l("div",_e,[c(ee,{for:"code",value:e(n)("code")},null,8,["value"]),c(L,{id:"code",modelValue:e(f).code,"onUpdate:modelValue":K[0]||(K[0]=F=>e(f).code=F),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:N(M,["enter"])},null,8,["modelValue"]),c(q,{message:e(f).errors.code,class:"mt-2"},null,8,["message"])])):p("",!0)])):p("",!0),w.value.length>0&&!r.value?(t(),l("div",ve,[u("div",we,[u("p",ge,o(e(n)("recoveryCodesMessage")),1)]),u("div",ye,[(t(!0),l(J,null,j(w.value,F=>(t(),l("div",{key:F},o(F),1))),128))])])):p("",!0)])):p("",!0),u("div",he,[d.value?(t(),l("div",ke,[c(k,{onConfirmed:M},{default:s(()=>[r.value?(t(),x(A,{key:0,type:"button",class:b(["me-3",{"opacity-25":m.value}]),disabled:m.value},{default:s(()=>[i(o(e(n)("confirm")),1)]),_:1},8,["class","disabled"])):p("",!0)]),_:1}),c(k,{onConfirmed:R},{default:s(()=>[w.value.length>0&&!r.value?(t(),x(T,{key:0,class:"me-3"},{default:s(()=>[i(o(e(n)("regenerateRecoveryCodes")),1)]),_:1})):p("",!0)]),_:1}),c(k,{onConfirmed:V},{default:s(()=>[w.value.length===0&&!r.value?(t(),x(T,{key:0,class:"me-3"},{default:s(()=>[i(o(e(n)("showRecoveryCodes")),1)]),_:1})):p("",!0)]),_:1}),c(k,{onConfirmed:P},{default:s(()=>[r.value?(t(),x(T,{key:0,class:b({"opacity-25":a.value}),disabled:a.value},{default:s(()=>[i(o(e(n)("cancel")),1)]),_:1},8,["class","disabled"])):p("",!0)]),_:1}),c(k,{onConfirmed:P},{default:s(()=>[r.value?p("",!0):(t(),x(Z,{key:0,class:b({"opacity-25":a.value}),disabled:a.value},{default:s(()=>[i(o(e(n)("disable")),1)]),_:1},8,["class","disabled"]))]),_:1})])):(t(),l("div",xe,[c(k,{onConfirmed:C},{default:s(()=>[c(A,{type:"button",class:b({"opacity-25":m.value}),disabled:m.value},{default:s(()=>[i(o(e(n)("enable")),1)]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{Be as default};
