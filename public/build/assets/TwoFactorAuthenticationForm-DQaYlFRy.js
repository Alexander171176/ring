import{u as q,l as g,bd as D,m as l,o as t,f as u,i as c,aW as Q,w as s,p as i,t as o,k as e,q as b,bc as L,aa as U,Q as z,T as G,G as W,C as j,e as x,n as p,F as J,v as O,E as B}from"./vendor-DbgL49-7.js";import{_ as X}from"./Modal-C9LlzT9A.js";import{_ as Y}from"./DialogModal-DM1A_3PP.js";import{_ as N,a as H}from"./TextInput-DEdIpUnr.js";import{_ as E}from"./PrimaryButton-BW-z9Kvz.js";import{_ as T}from"./SecondaryButton-C_2oxhM3.js";import{_ as Z}from"./DangerButton-DHJDjC7J.js";import{_ as ee}from"./InputLabel-CUsWtfhI.js";import"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-286Uv_vn.js";import"./SectionTitle-4XlqOdEg.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"mt-4"},k={__name:"ConfirmsPassword",props:{title:{type:String},content:{type:String},button:{type:String}},emits:["confirmed"],setup(M,{emit:S}){const{t:h}=q(),m=S,r=g(!1),a=D({password:"",error:"",processing:!1}),v=g(null),y=()=>{axios.get(route("password.confirmation")).then(d=>{d.data.confirmed?m("confirmed"):(r.value=!0,setTimeout(()=>v.value.focus(),250))})},w=()=>{a.processing=!0,axios.post(route("password.confirm"),{password:a.password}).then(()=>{a.processing=!1,f(),U().then(()=>m("confirmed"))}).catch(d=>{a.processing=!1,a.error=d.response.data.errors.password[0],v.value.focus()})},f=()=>{r.value=!1,a.password="",a.error=""};return(d,C)=>(t(),l("span",null,[u("span",{onClick:y},[Q(d.$slots,"default")]),c(Y,{show:r.value,onClose:f},{title:s(()=>[i(o(e(h)("confirmPassword")),1)]),content:s(()=>[i(o(e(h)("securityMessage"))+" ",1),u("div",te,[c(N,{ref_key:"passwordInput",ref:v,modelValue:a.password,"onUpdate:modelValue":C[0]||(C[0]=$=>a.password=$),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:L(w,["enter"])},null,8,["modelValue"]),c(H,{message:a.error,class:"mt-2"},null,8,["message"])])]),footer:s(()=>[c(T,{onClick:f},{default:s(()=>[i(o(e(h)("cancel")),1)]),_:1}),c(E,{class:b(["ms-3",{"opacity-25":a.processing}]),disabled:a.processing,onClick:w},{default:s(()=>[i(o(e(h)("confirm")),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},oe={key:0,class:"text-xl font-medium text-orange-400 dark:text-orange-200"},se={key:1,class:"text-xl font-medium text-orange-400 dark:text-orange-200"},ae={key:2,class:"text-xl font-medium text-orange-400 dark:text-orange-200"},re={class:"mt-3 max-w-xl font-semibold text-lg text-indigo-900 dark:text-sky-200"},ne={key:3},le={key:0},ce={class:"mt-4 max-w-xl font-semibold text-lg text-indigo-900 dark:text-sky-200"},ie={key:0,class:"font-semibold"},de={key:1},ue=["innerHTML"],me={key:0,class:"mt-4 max-w-xl text-lg text-orange-500"},fe={class:"font-semibold"},pe=["innerHTML"],_e={key:1,class:"mt-4"},ve={key:1},we={class:"mt-4 max-w-xl text-lg text-indigo-900 dark:text-sky-200"},ge={class:"font-semibold"},he={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-lg bg-gray-100 rounded-lg"},ye={class:"mt-5"},xe={key:0},ke={key:1},Be={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(M){const S=M,h=z(),m=g(!1),r=g(!1),a=g(!1),v=g(null),y=g(null),w=g([]),f=G({code:""}),d=W(()=>{var _;return!m.value&&((_=h.props.auth.user)==null?void 0:_.two_factor_enabled)});j(d,()=>{d.value||(f.reset(),f.clearErrors())});const C=()=>{m.value=!0,B.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([$(),R(),V()]),onFinish:()=>{m.value=!1,r.value=S.requiresConfirmation}})},$=()=>axios.get(route("two-factor.qr-code")).then(_=>{v.value=_.data.svg}),R=()=>axios.get(route("two-factor.secret-key")).then(_=>{y.value=_.data.secretKey}),V=()=>axios.get(route("two-factor.recovery-codes")).then(_=>{w.value=_.data}),A=()=>{f.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{r.value=!1,v.value=null,y.value=null}})},I=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>V())},K=()=>{a.value=!0,B.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{a.value=!1,r.value=!1}})},{t:n}=q();return(_,P)=>(t(),x(X,null,{title:s(()=>[i(o(e(n)("twoFactorAuthentication")),1)]),description:s(()=>[i(o(e(n)("twoFactorAuthenticationDescription")),1)]),content:s(()=>[d.value&&!r.value?(t(),l("h3",oe,o(e(n)("twoFactorEnabled")),1)):d.value&&r.value?(t(),l("h3",se,o(e(n)("completeTwoFactorSetup")),1)):(t(),l("h3",ae,o(e(n)("twoFactorNotEnabled")),1)),u("div",re,[u("p",null,o(e(n)("twoFactorExplanation")),1)]),d.value?(t(),l("div",ne,[v.value?(t(),l("div",le,[u("div",ce,[r.value?(t(),l("p",ie,o(e(n)("completeTwoFactorEnable")),1)):(t(),l("p",de,o(e(n)("twoFactorEnabledMessage")),1))]),u("div",{class:"mt-4 p-2 inline-block bg-white",innerHTML:v.value},null,8,ue),y.value?(t(),l("div",me,[u("p",fe,[i(o(e(n)("setupKey"))+": ",1),u("span",{innerHTML:y.value},null,8,pe)])])):p("",!0),r.value?(t(),l("div",_e,[c(ee,{for:"code",value:e(n)("code")},null,8,["value"]),c(N,{id:"code",modelValue:e(f).code,"onUpdate:modelValue":P[0]||(P[0]=F=>e(f).code=F),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:L(A,["enter"])},null,8,["modelValue"]),c(H,{message:e(f).errors.code,class:"mt-2"},null,8,["message"])])):p("",!0)])):p("",!0),w.value.length>0&&!r.value?(t(),l("div",ve,[u("div",we,[u("p",ge,o(e(n)("recoveryCodesMessage")),1)]),u("div",he,[(t(!0),l(J,null,O(w.value,F=>(t(),l("div",{key:F},o(F),1))),128))])])):p("",!0)])):p("",!0),u("div",ye,[d.value?(t(),l("div",ke,[c(k,{onConfirmed:A},{default:s(()=>[r.value?(t(),x(E,{key:0,type:"button",class:b(["me-3",{"opacity-25":m.value}]),disabled:m.value},{default:s(()=>[i(o(e(n)("confirm")),1)]),_:1},8,["class","disabled"])):p("",!0)]),_:1}),c(k,{onConfirmed:I},{default:s(()=>[w.value.length>0&&!r.value?(t(),x(T,{key:0,class:"me-3"},{default:s(()=>[i(o(e(n)("regenerateRecoveryCodes")),1)]),_:1})):p("",!0)]),_:1}),c(k,{onConfirmed:V},{default:s(()=>[w.value.length===0&&!r.value?(t(),x(T,{key:0,class:"me-3"},{default:s(()=>[i(o(e(n)("showRecoveryCodes")),1)]),_:1})):p("",!0)]),_:1}),c(k,{onConfirmed:K},{default:s(()=>[r.value?(t(),x(T,{key:0,class:b({"opacity-25":a.value}),disabled:a.value},{default:s(()=>[i(o(e(n)("cancel")),1)]),_:1},8,["class","disabled"])):p("",!0)]),_:1}),c(k,{onConfirmed:K},{default:s(()=>[r.value?p("",!0):(t(),x(Z,{key:0,class:b({"opacity-25":a.value}),disabled:a.value},{default:s(()=>[i(o(e(n)("disable")),1)]),_:1},8,["class","disabled"]))]),_:1})])):(t(),l("div",xe,[c(k,{onConfirmed:C},{default:s(()=>[c(E,{type:"button",class:b({"opacity-25":m.value}),disabled:m.value},{default:s(()=>[i(o(e(n)("enable")),1)]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{Be as default};
