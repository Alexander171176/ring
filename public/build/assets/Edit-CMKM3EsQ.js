import{r as v,A as I,P as j,D as m,H as l,k as o,I as f,J as c,u as e,L as z,y as T}from"./vue-DrbZvlgE.js";import{a as A,u as D,T as M}from"./app-Bp8GUED0.js";import{A as E}from"./AdminLayout-m43ZpFmT.js";import{T as L}from"./TitlePage-CVAOVWeu.js";import{_ as y}from"./DefaultButton-B4OupGBJ.js";import{_ as d,a as w,b as C}from"./InputText-DBtoU87u.js";import{_,a as x,b as N}from"./InputNumber-D963n_HP.js";import{_ as V}from"./MetaDescTextarea-DjPUZo-s.js";import{_ as p}from"./InputError-CDoDc20f.js";import{s as S}from"./vue-multiselect.min.css_vue_type_style_index_0_src_true_lang-DWHVxuBV.js";import{_ as P}from"./MultiImageUpload-Cl2NMbU3.js";import{_ as q}from"./MultiImageEdit-CHMwr59A.js";import"./vendor-CGnu3J7H.js";import"./ScrollButtons-DwaEk0p5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-Cy7DQwuF.js";import"./LocaleSelectOption-DauWSBmB.js";import"./auth-image-XbvYdkSi.js";const F={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},O={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},Z={class:"sm:flex sm:justify-between sm:items-center mb-2"},H=l("svg",{class:"w-4 h-4 fill-current text-slate-100 shrink-0 mr-2",viewBox:"0 0 16 16"},[l("path",{d:"M4.3 4.5c1.9-1.9 5.1-1.9 7 0 .7.7 1.2 1.7 1.4 2.7l2-.3c-.2-1.5-.9-2.8-1.9-3.8C10.1.4 5.7.4 2.9 3.1L.7.9 0 7.3l6.4-.7-2.1-2.1zM15.6 8.7l-6.4.7 2.1 2.1c-1.9 1.9-5.1 1.9-7 0-.7-.7-1.2-1.7-1.4-2.7l-2 .3c.2 1.5.9 2.8 1.9 3.8 1.4 1.4 3.1 2 4.9 2 1.8 0 3.6-.7 4.9-2l2.2 2.2.8-6.4z"})],-1),J=l("div",{class:"grid grid-flow-col sm:auto-cols-max justify-start sm:justify-end gap-2"},null,-1),G={class:"mb-3 flex justify-between flex-col lg:flex-row items-center gap-4"},K={class:"flex flex-row items-center gap-2"},Q={class:"flex flex-row items-center gap-2"},R={class:"h-8 flex items-center"},W={class:"mb-3 flex justify-between flex-col lg:flex-row items-center gap-4"},X={class:"flex flex-row items-center gap-2"},Y={class:"flex flex-row items-center gap-2"},ee={class:"mb-3 flex flex-col items-start"},te={class:"mb-3 flex flex-col items-start"},se=l("span",{class:"text-red-500 dark:text-red-300 font-semibold"},"*",-1),le={class:"mb-3 flex flex-col items-start"},ae={class:"mb-3 flex flex-col items-start"},oe={class:"flex justify-between w-full"},re={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},ie={class:"mb-3 flex flex-col items-start"},ne={class:"flex justify-between w-full"},me={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},ce={class:"mt-4"},de={class:"mt-4"},ue={class:"flex items-center justify-center mt-4"},fe=l("svg",{class:"w-4 h-4 fill-current text-slate-100 shrink-0 mr-2",viewBox:"0 0 16 16"},[l("path",{d:"M4.3 4.5c1.9-1.9 5.1-1.9 7 0 .7.7 1.2 1.7 1.4 2.7l2-.3c-.2-1.5-.9-2.8-1.9-3.8C10.1.4 5.7.4 2.9 3.1L.7.9 0 7.3l6.4-.7-2.1-2.1zM15.6 8.7l-6.4.7 2.1 2.1c-1.9 1.9-5.1 1.9-7 0-.7-.7-1.2-1.7-1.4-2.7l-2 .3c-.2 1.5.9 2.8 1.9 3.8 1.4 1.4 3.1 2 4.9 2 1.8 0 3.6-.7 4.9-2l2.2 2.2 .8-6.4z"})],-1),pe=l("svg",{class:"w-4 h-4 fill-current text-slate-100",viewBox:"0 0 16 16"},[l("path",{d:"M14.3 2.3L5 11.6 1.7 8.3c-.4-.4-1-.4-1.4 0-.4.4-.4 1 0 1.4l4 4c.2.2.4.3.7.3.3 0 .5-.1.7-.3l10-10c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0z"})],-1),De={__name:"Edit",props:{banner:{type:Object,required:!0},sections:Array},setup(g){const h=A(),{t:r}=D(),n=g,t=M({_method:"PUT",sort:n.banner.sort??0,title:n.banner.title??"",link:n.banner.link??"",short:n.banner.short??"",comment:n.banner.comment??"",activity:!!n.banner.activity,left:!!n.banner.left,right:!!n.banner.right,sections:n.banner.sections??[],deletedImages:[]}),u=v((n.banner.images||[]).filter(a=>a.url).map(a=>({id:a.id,url:a.webp_url||a.url,order:a.order||0,alt:a.alt||"",caption:a.caption||""}))),b=v([]),k=a=>{u.value=a},U=a=>{t.deletedImages.includes(a)||t.deletedImages.push(a),u.value=u.value.filter(s=>s.id!==a)},$=a=>{b.value=a},B=()=>{t.transform(a=>({...a,activity:a.activity?1:0,left:a.left?1:0,right:a.right?1:0,images:[...b.value.map(s=>({file:s.file,order:s.order,alt:s.alt,caption:s.caption})),...u.value.map(s=>({id:s.id,order:s.order,alt:s.alt,caption:s.caption}))],deletedImages:t.deletedImages})),t.post(route("admin.banners.update",n.banner.id),{preserveScroll:!0,forceFormData:!0,onSuccess:a=>{h.success("Баннер успешно обновлён!")},onError:a=>{console.error("❌ Ошибка при обновлении баннера:",a);const s=a[Object.keys(a)[0]];h.error(s||"Пожалуйста, проверьте правильность заполнения полей.")}})};return(a,s)=>(j(),I(E,{title:e(r)("editBanner")},{header:m(()=>[o(L,null,{default:m(()=>[f(c(e(r)("editBanner"))+": "+c(n.banner.title),1)]),_:1})]),default:m(()=>[l("div",F,[l("div",O,[l("div",Z,[o(y,{href:a.route("admin.banners.index")},{icon:m(()=>[H]),default:m(()=>[f(" "+c(e(r)("back")),1)]),_:1},8,["href"]),J]),l("form",{onSubmit:z(B,["prevent"]),enctype:"multipart/form-data",class:"p-3 w-full"},[l("div",G,[l("div",K,[o(_,{modelValue:e(t).activity,"onUpdate:modelValue":s[0]||(s[0]=i=>e(t).activity=i)},null,8,["modelValue"]),o(x,{for:"activity",text:e(r)("activity"),class:"text-sm h-8 flex items-center"},null,8,["text"])]),l("div",Q,[l("div",R,[o(d,{for:"sort",value:e(r)("sort"),class:"text-sm"},null,8,["value"])]),o(N,{id:"sort",type:"number",modelValue:e(t).sort,"onUpdate:modelValue":s[1]||(s[1]=i=>e(t).sort=i),autocomplete:"sort",class:"w-full lg:w-28"},null,8,["modelValue"]),o(p,{class:"mt-2 lg:mt-0",message:e(t).errors.sort},null,8,["message"])])]),l("div",W,[l("div",X,[o(_,{modelValue:e(t).left,"onUpdate:modelValue":s[2]||(s[2]=i=>e(t).left=i)},null,8,["modelValue"]),o(x,{for:"left",text:e(r)("left"),class:"text-sm h-8 flex items-center"},null,8,["text"])]),l("div",Y,[o(_,{modelValue:e(t).right,"onUpdate:modelValue":s[3]||(s[3]=i=>e(t).right=i)},null,8,["modelValue"]),o(x,{for:"right",text:e(r)("right"),class:"text-sm h-8 flex items-center"},null,8,["text"])])]),l("div",ee,[o(d,{for:"sections",value:e(r)("sections"),class:"mb-1"},null,8,["value"]),o(e(S),{modelValue:e(t).sections,"onUpdate:modelValue":s[4]||(s[4]=i=>e(t).sections=i),options:g.sections,multiple:!0,"close-on-select":!0,placeholder:e(r)("select"),label:"title","track-by":"title"},null,8,["modelValue","options","placeholder"])]),l("div",te,[o(d,{for:"title"},{default:m(()=>[se,f(" "+c(e(r)("bannerTitle")),1)]),_:1}),o(w,{id:"title",type:"text",modelValue:e(t).title,"onUpdate:modelValue":s[5]||(s[5]=i=>e(t).title=i),required:"",autocomplete:"title"},null,8,["modelValue"]),o(p,{class:"mt-2",message:e(t).errors.title},null,8,["message"])]),l("div",le,[o(d,{for:"link",value:e(r)("url")},null,8,["value"]),o(w,{id:"link",type:"text",modelValue:e(t).link,"onUpdate:modelValue":s[6]||(s[6]=i=>e(t).link=i),autocomplete:"link",pattern:"^(https?:\\/\\/)?[A-Za-z0-9\\.\\-]+(:[0-9]+)?(\\/[A-Za-z0-9\\-\\/]+)?$",title:e(r)("urlVerification")},null,8,["modelValue","title"]),o(p,{class:"mt-2",message:e(t).errors.link},null,8,["message"])]),l("div",ae,[l("div",oe,[o(d,{for:"short",value:e(r)("shortDescription")},null,8,["value"]),l("div",re,c(e(t).short.length)+" / 255 "+c(e(r)("characters")),1)]),o(V,{modelValue:e(t).short,"onUpdate:modelValue":s[7]||(s[7]=i=>e(t).short=i),class:"w-full"},null,8,["modelValue"]),o(p,{class:"mt-2",message:e(t).errors.short},null,8,["message"])]),l("div",ie,[l("div",ne,[o(d,{for:"comment",value:e(r)("comment")},null,8,["value"]),l("div",me,c(e(t).comment.length)+" / 255 "+c(e(r)("characters")),1)]),o(V,{modelValue:e(t).comment,"onUpdate:modelValue":s[8]||(s[8]=i=>e(t).comment=i),class:"w-full"},null,8,["modelValue"]),o(p,{class:"mt-2",message:e(t).errors.comment},null,8,["message"])]),l("div",ce,[o(q,{images:u.value,"onUpdate:images":k,onDeleteImage:U},null,8,["images"])]),l("div",de,[o(P,{"onUpdate:images":$})]),l("div",ue,[o(y,{href:a.route("admin.banners.index"),class:"mb-3"},{icon:m(()=>[fe]),default:m(()=>[f(" "+c(e(r)("back")),1)]),_:1},8,["href"]),o(C,{class:T(["ms-4 mb-0",{"opacity-25":e(t).processing}]),disabled:e(t).processing},{icon:m(()=>[pe]),default:m(()=>[f(" "+c(e(r)("save")),1)]),_:1},8,["disabled","class"])])],32)])])]),_:1},8,["title"]))}};export{De as default};
