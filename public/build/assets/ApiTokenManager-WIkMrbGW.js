import{T,l as $,u as j,m as c,o as m,i as a,n as g,w as t,k as e,p as i,t as s,q as x,f as r,F as h,v as A}from"./vendor-DbgL49-7.js";import{_ as q}from"./ActionMessage-4hnr5-hk.js";import{_ as z}from"./Modal-C9LlzT9A.js";import{_ as S}from"./Checkbox-DRiE9auo.js";import{_ as E}from"./ConfirmationModal-WhQQgCpc.js";import{_ as I}from"./DangerButton-DHJDjC7J.js";import{_ as w}from"./DialogModal-DM1A_3PP.js";import{_ as L}from"./FormSection-CqzG6t96.js";import{_ as M,a as G}from"./TextInput-DEdIpUnr.js";import{_ as P}from"./InputLabel-CUsWtfhI.js";import{_ as V}from"./PrimaryButton-BW-z9Kvz.js";import{_ as C}from"./SecondaryButton-C_2oxhM3.js";import{S as H}from"./SectionBorder-IQTcTgBt.js";import"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-286Uv_vn.js";import"./SectionTitle-4XlqOdEg.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"col-span-6 sm:col-span-4"},K={key:0,class:"col-span-6"},O={class:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4"},Q={class:"flex items-center"},R={class:"ms-2 text-sm text-gray-600"},W={key:0},X={class:"mt-10 sm:mt-0"},Y={class:"space-y-6"},Z={class:"break-all"},ee={class:"flex items-center ms-2"},se={key:0,class:"text-sm text-gray-400"},te=["onClick"],oe=["onClick"],ne={key:0,class:"mt-4 bg-gray-100 px-4 py-2 rounded font-mono text-sm text-gray-500 break-all"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},le={class:"flex items-center"},ie={class:"ms-2 text-sm text-gray-600"},Ce={__name:"ApiTokenManager",props:{tokens:Array,availablePermissions:Array,defaultPermissions:Array},setup(d){const u=T({name:"",permissions:d.defaultPermissions}),f=T({permissions:[]}),b=T({}),y=$(!1),v=$(null),_=$(null),{t:n}=j(),D=()=>{u.post(route("api-tokens.store"),{preserveScroll:!0,onSuccess:()=>{y.value=!0,u.reset()}})},F=p=>{f.permissions=p.abilities,v.value=p},B=()=>{f.put(route("api-tokens.update",v.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>v.value=null})},N=p=>{_.value=p},U=()=>{b.delete(route("api-tokens.destroy",_.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>_.value=null})};return(p,l)=>(m(),c("div",null,[a(L,{onSubmitted:D},{title:t(()=>[i(s(e(n)("createApiToken")),1)]),description:t(()=>[i(s(e(n)("apiTokensDescription")),1)]),form:t(()=>[r("div",J,[a(P,{for:"name",value:e(n)("name")},null,8,["value"]),a(M,{id:"name",modelValue:e(u).name,"onUpdate:modelValue":l[0]||(l[0]=o=>e(u).name=o),type:"text",class:"mt-1 block w-full",autofocus:""},null,8,["modelValue"]),a(G,{message:e(u).errors.name,class:"mt-2"},null,8,["message"])]),d.availablePermissions.length>0?(m(),c("div",K,[a(P,{for:"permissions",value:e(n)("permissions")},null,8,["value"]),r("div",O,[(m(!0),c(h,null,A(d.availablePermissions,o=>(m(),c("div",{key:o},[r("label",Q,[a(S,{checked:e(u).permissions,"onUpdate:checked":l[1]||(l[1]=k=>e(u).permissions=k),value:o},null,8,["checked","value"]),r("span",R,s(o),1)])]))),128))])])):g("",!0)]),actions:t(()=>[a(q,{on:e(u).recentlySuccessful,class:"me-3"},{default:t(()=>[i(s(e(n)("created")),1)]),_:1},8,["on"]),a(V,{class:x({"opacity-25":e(u).processing}),disabled:e(u).processing},{default:t(()=>[i(s(e(n)("create")),1)]),_:1},8,["class","disabled"])]),_:1}),d.tokens.length>0?(m(),c("div",W,[a(H),r("div",X,[a(z,null,{title:t(()=>[i(s(e(n)("manageApiTokens")),1)]),description:t(()=>[i(s(e(n)("manageApiTokensDescription")),1)]),content:t(()=>[r("div",Y,[(m(!0),c(h,null,A(d.tokens,o=>(m(),c("div",{key:o.id,class:"flex items-center justify-between"},[r("div",Z,s(o.name),1),r("div",ee,[o.last_used_ago?(m(),c("div",se,s(e(n)("lastUsed"))+" "+s(o.last_used_ago),1)):g("",!0),d.availablePermissions.length>0?(m(),c("button",{key:1,class:"cursor-pointer ms-6 text-sm text-gray-400 underline",onClick:k=>F(o)},s(e(n)("permissions")),9,te)):g("",!0),r("button",{class:"cursor-pointer ms-6 text-sm text-red-500",onClick:k=>N(o)},s(e(n)("delete")),9,oe)])]))),128))])]),_:1})])])):g("",!0),a(w,{show:y.value,onClose:l[3]||(l[3]=o=>y.value=!1)},{title:t(()=>[i(s(e(n)("apiToken")),1)]),content:t(()=>[r("div",null,s(e(n)("copyToken")),1),p.$page.props.jetstream.flash.token?(m(),c("div",ne,s(p.$page.props.jetstream.flash.token),1)):g("",!0)]),footer:t(()=>[a(C,{onClick:l[2]||(l[2]=o=>y.value=!1)},{default:t(()=>[i(s(e(n)("close")),1)]),_:1})]),_:1},8,["show"]),a(w,{show:v.value!=null,onClose:l[6]||(l[6]=o=>v.value=null)},{title:t(()=>[i(s(e(n)("apiTokenPermissions")),1)]),content:t(()=>[r("div",ae,[(m(!0),c(h,null,A(d.availablePermissions,o=>(m(),c("div",{key:o},[r("label",le,[a(S,{checked:e(f).permissions,"onUpdate:checked":l[4]||(l[4]=k=>e(f).permissions=k),value:o},null,8,["checked","value"]),r("span",ie,s(o),1)])]))),128))])]),footer:t(()=>[a(C,{onClick:l[5]||(l[5]=o=>v.value=null)},{default:t(()=>[i(s(e(n)("cancel")),1)]),_:1}),a(V,{class:x(["ms-3",{"opacity-25":e(f).processing}]),disabled:e(f).processing,onClick:B},{default:t(()=>[i(s(e(n)("save")),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"]),a(E,{show:_.value!=null,onClose:l[8]||(l[8]=o=>_.value=null)},{title:t(()=>[i(s(e(n)("deleteApiToken")),1)]),content:t(()=>[i(s(e(n)("confirmDeleteToken")),1)]),footer:t(()=>[a(C,{onClick:l[7]||(l[7]=o=>_.value=null)},{default:t(()=>[i(s(e(n)("cancel")),1)]),_:1}),a(I,{class:x(["ms-3",{"opacity-25":e(b).processing}]),disabled:e(b).processing,onClick:U},{default:t(()=>[i(s(e(n)("delete")),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}};export{Ce as default};
