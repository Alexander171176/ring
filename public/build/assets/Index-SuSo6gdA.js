import{u as z,a as K,F as k}from"./app-Bp8GUED0.js";import{d as G,A as Q}from"./AdminLayout-m43ZpFmT.js";import{T as R}from"./TitlePage-CVAOVWeu.js";import{_ as q}from"./DefaultButton-B4OupGBJ.js";import{_ as W,a as X,b as Y}from"./CountTable-d-g2mUkX.js";import{_ as Z,a as ee,b as te}from"./SearchInput-BnTfTW5z.js";import{_ as se}from"./ActivityToggle-BmERT0AZ.js";import{_ as oe}from"./IconEdit-CBGH9coF.js";import{r as x,w as V,x as y,P as v,H as e,k as h,J as l,u as n,D as $,b as B,A as D,G as P,I as j}from"./vue-DrbZvlgE.js";import"./vendor-CGnu3J7H.js";import"./ScrollButtons-DwaEk0p5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-Cy7DQwuF.js";import"./LocaleSelectOption-DauWSBmB.js";import"./auth-image-XbvYdkSi.js";const ae={class:"bg-white dark:bg-slate-700 shadow-lg rounded-sm border border-slate-200 dark:border-slate-600 relative"},le={class:"overflow-x-auto"},ne={key:0,class:"table-auto w-full text-slate-700 dark:text-slate-100"},re={class:"text-sm font-semibold uppercase bg-slate-200 dark:bg-cyan-900 border border-solid border-gray-300 dark:border-gray-700"},ie={class:"px-2 py-1 whitespace-nowrap w-1/12"},ce={class:"font-medium text-center"},de={class:"px-2 py-1 whitespace-nowrap w-1/12"},ue=["title"],me=e("svg",{class:"w-6 h-6 fill-current shrink-0",viewBox:"0 0 512 512"},[e("path",{d:"M0 96C0 60.7 28.7 32 64 32l384 0c35.3 0 64 28.7 64 64l0 320c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96zM323.8 202.5c-4.5-6.6-11.9-10.5-19.8-10.5s-15.4 3.9-19.8 10.5l-87 127.6L170.7 297c-4.6-5.7-11.5-9-18.7-9s-14.2 3.3-18.7 9l-64 80c-5.8 7.2-6.9 17.1-2.9 25.4s12.4 13.6 21.6 13.6l96 0 32 0 208 0c8.9 0 17.1-4.9 21.2-12.8s3.6-17.4-1.4-24.7l-120-176zM112 192a48 48 0 1 0 0-96 48 48 0 1 0 0 96z"})],-1),pe=[me],ve={class:"px-2 py-1 whitespace-nowrap w-1/12"},_e=["title"],he=e("svg",{class:"w-8 h-8 fill-current shrink-0",viewBox:"0 0 640 512"},[e("path",{d:"M0 128C0 92.7 28.7 64 64 64l192 0 48 0 16 0 256 0c35.3 0 64 28.7 64 64l0 256c0 35.3-28.7 64-64 64l-256 0-16 0-48 0L64 448c-35.3 0-64-28.7-64-64L0 128zm320 0l0 256 256 0 0-256-256 0zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1 .1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1 73.6 0 8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2L179 276l-38 0 19-42.8zM448 164c11 0 20 9 20 20l0 4 44 0 16 0c11 0 20 9 20 20s-9 20-20 20l-2 0-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4c.9 .6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9l-18.9-11.3c-4.5-2.7-8.8-5.5-13.1-8.5c-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8l-12.2-12.2c-7.8-7.8-7.8-20.5 0-28.3s20.5-7.8 28.3 0l14.6 14.6 .5 .5c12.4-13.1 22.5-28.3 29.8-45L448 228l-72 0c-11 0-20-9-20-20s9-20 20-20l52 0 0-4c0-11 9-20 20-20z"})],-1),fe=[he],ge={class:"px-2 py-1 whitespace-nowrap w-2/12"},we={class:"font-medium text-left"},xe={class:"px-2 py-1 whitespace-nowrap w-2/12"},ye={class:"font-medium text-left"},be={class:"px-2 py-1 whitespace-nowrap w-2/12"},ke={class:"font-medium text-left"},$e={class:"px-2 py-1 whitespace-nowrap w-2/12"},Se={class:"font-medium text-left"},Te={class:"px-2 py-1 whitespace-nowrap w-2/12"},Ae={class:"font-medium text-left"},Ce={class:"px-2 py-1 whitespace-nowrap w-2/12"},De={class:"font-medium text-left"},Pe={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},ze={class:"font-semibold text-end"},Le={class:"px-2 first:pl-7 last:pr-7 py-3 whitespace-nowrap"},Me={class:"text-center font-medium"},Ue={class:"text-sm font-semibold border-b-2 hover:bg-slate-100 dark:hover:bg-cyan-800"},Be={class:"px-2 py-1 whitespace-nowrap w-1/12"},je={class:"text-center text-blue-600 dark:text-blue-200"},Ve={class:"px-2 py-1 whitespace-nowrap w-1/12"},Ee={class:"flex justify-center"},Ne=["src"],Ie={key:1,src:"/storage/tournament_images/default-image.png",class:"h-8 w-8 object-cover rounded-full",alt:"image"},Oe={class:"px-2 py-1 whitespace-nowrap w-1/12"},Fe={class:"text-center uppercase text-orange-500 dark:text-orange-200"},He={class:"px-2 py-1 whitespace-nowrap w-2/12"},Je={class:"text-left text-rose-500 dark:text-rose-200"},Ke={class:"px-2 py-1 whitespace-nowrap w-2/12"},Ge={class:"text-left text-teal-500 dark:text-teal-200"},Qe={class:"px-2 py-1 whitespace-nowrap w-2/12"},Re={class:"text-left text-blue-500 dark:text-blue-200"},qe={class:"px-2 py-1 whitespace-nowrap w-2/12"},We={class:"text-left text-yellow-500 dark:text-yellow-200"},Xe={class:"px-2 py-1 whitespace-nowrap w-2/12"},Ye={class:"text-left text-rose-500 dark:text-rose-200"},Ze={class:"px-2 py-1 whitespace-nowrap w-2/12"},et={class:"text-left text-fuchsia-500 dark:text-fuchsia-200"},tt={class:"px-2 py-1 whitespace-nowrap text-right w-2/12"},st={class:"flex justify-end space-x-2"},ot={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},at={class:"text-center"},lt=["checked","onChange"],nt={key:1,class:"p-5 text-center text-slate-700 dark:text-slate-100"},rt={__name:"TournamentTable",props:{tournaments:Array,selectedTournaments:Array},emits:["toggle-activity","edit","delete","update-sort-order","toggle-select","toggle-all"],setup(m,{emit:_}){const{t:s}=z(),w=m,d=_,c=r=>s(r?`tournamentType${r.charAt(0).toUpperCase()+r.slice(1).replace(/_([a-z])/g,(p,i)=>i.toUpperCase())}`:"unknown"),S=r=>s(r?`tournamentStatus${r.charAt(0).toUpperCase()+r.slice(1)}`:"unknown"),b=r=>r?new Date(r).toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):s("unknown"),f=x([]);V(()=>w.tournaments,r=>{f.value=JSON.parse(JSON.stringify(r||[]))},{immediate:!0,deep:!0});const L=()=>{const r=f.value.map(p=>p.id);d("update-sort-order",r)},T=r=>{const p=r.target.checked,i=f.value.map(A=>A.id);d("toggle-all",{ids:i,checked:p})},C=r=>Array.isArray(r.images)&&r.images.length>0&&r.images[0].url?r.images[0].url:"/storage/tournament_images/default-image.png";return(r,p)=>(v(),y("div",ae,[e("div",le,[m.tournaments.length>0?(v(),y("table",ne,[e("thead",re,[e("tr",null,[e("th",ie,[e("div",ce,l(n(s)("id")),1)]),e("th",de,[e("div",{class:"flex justify-center",title:n(s)("image")},pe,8,ue)]),e("th",ve,[e("div",{class:"flex justify-center",title:n(s)("localization")},fe,8,_e)]),e("th",ge,[e("div",we,l(n(s)("name")),1)]),e("th",xe,[e("div",ye,l(n(s)("type")),1)]),e("th",be,[e("div",ke,l(n(s)("date")),1)]),e("th",$e,[e("div",Se,l(n(s)("city")),1)]),e("th",Te,[e("div",Ae,l(n(s)("venue")),1)]),e("th",Ce,[e("div",De,l(n(s)("status")),1)]),e("th",Pe,[e("div",ze,l(n(s)("actions")),1)]),e("th",Le,[e("div",Me,[e("input",{type:"checkbox",onChange:T},null,32)])])])]),h(n(G),{tag:"tbody",modelValue:f.value,"onUpdate:modelValue":p[0]||(p[0]=i=>f.value=i),onEnd:L,itemKey:"id"},{item:$(({element:i})=>[e("tr",Ue,[e("td",Be,[e("div",je,l(i.id),1)]),e("td",Ve,[e("div",Ee,[C(i)?(v(),y("img",{key:0,src:C(i),class:"h-8 w-8 object-cover rounded-full",alt:"image"},null,8,Ne)):(v(),y("img",Ie))])]),e("td",Oe,[e("div",Fe,l(i.locale),1)]),e("td",He,[e("div",Je,l(i.name),1)]),e("td",Ke,[e("div",Ge,l(c(i.type)),1)]),e("td",Qe,[e("div",Re,l(b(i.tournament_date_time)),1)]),e("td",qe,[e("div",We,l(i.city),1)]),e("td",Xe,[e("div",Ye,l(i.venue),1)]),e("td",Ze,[e("div",et,l(S(i.status)),1)]),e("td",tt,[e("div",st,[h(se,{isActive:i.activity,onToggleActivity:A=>r.$emit("toggle-activity",i),title:i.activity?n(s)("enabled"):n(s)("disabled")},null,8,["isActive","onToggleActivity","title"]),h(oe,{href:r.route("admin.tournaments.edit",i.id)},null,8,["href"]),h(W,{onClick:A=>r.$emit("delete",i.id)},null,8,["onClick"])])]),e("td",ot,[e("div",at,[e("input",{type:"checkbox",checked:m.selectedTournaments.includes(i.id),onChange:A=>r.$emit("toggle-select",i.id)},null,40,lt)])])])]),_:1},8,["modelValue"])])):(v(),y("div",nt,l(n(s)("noData")),1))])]))}},it={class:"flex flex-col sm:flex-row items-center"},ct={class:"block mb-2 sm:mb-0 sm:mr-2 font-semibold text-sm text-slate-700 dark:text-slate-500"},dt={value:"",disabled:"",selected:""},ut={value:"selectAll"},mt={value:"deselectAll"},pt={value:"activate"},vt={value:"deactivate"},_t={value:"delete"},ht={__name:"BulkActionSelect",props:{handleBulkAction:Function},emits:["change"],setup(m,{emit:_}){const{t:s}=z();return(w,d)=>(v(),y("div",it,[e("label",ct,l(n(s)("bulkActions")),1),e("select",{class:"w-auto px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm",onChange:d[0]||(d[0]=c=>w.$emit("change",c))},[e("option",dt,l(n(s)("selectAction")),1),e("option",ut,l(n(s)("selectAll")),1),e("option",mt,l(n(s)("deselectAll")),1),e("option",pt,l(n(s)("activate")),1),e("option",vt,l(n(s)("deactivate")),1),e("option",_t,l(n(s)("deleteSelected")),1)],32)]))}},ft={class:"flex justify-center items-center h-fit sm:mr-4 mt-2 mb-2"},gt={for:"sortParam",class:"hidden lg:block sm:mr-2 tracking-wider text-sm font-semibold text-slate-600 dark:text-slate-100"},wt=["value"],xt={value:"idDesc"},yt={value:"idAsc"},bt={value:"sort"},kt={value:"name"},$t={value:"locale"},St={value:"views"},Tt={value:"activity"},At={value:"inactive"},Ct={__name:"SortSelect",props:{sortParam:String},emits:["update:sortParam"],setup(m,{emit:_}){const{t:s}=z(),w=_,d=c=>{w("update:sortParam",c.target.value)};return(c,S)=>(v(),y("div",ft,[e("label",gt,l(n(s)("sort")),1),e("select",{id:"sortParam",value:m.sortParam,onChange:d,class:"w-36 px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm"},[e("option",xt,l(n(s)("idDesc")),1),e("option",yt,l(n(s)("idAsc")),1),e("option",bt,l(n(s)("sortNumber")),1),e("option",kt,l(n(s)("name")),1),e("option",$t,l(n(s)("localization")),1),e("option",St,l(n(s)("views")),1),e("option",Tt,l(n(s)("active")),1),e("option",At,l(n(s)("inactive")),1)],40,wt)]))}},Dt={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},Pt={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},zt={class:"sm:flex sm:justify-between sm:items-center mb-2"},Lt=e("svg",{class:"w-4 h-4 fill-current opacity-50 shrink-0",viewBox:"0 0 16 16"},[e("path",{d:"M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z"})],-1),Mt={key:2,class:"flex justify-between items-center flex-col md:flex-row my-1"},qt={__name:"Index",props:["tournaments","tournamentsCount","adminCountTournaments","adminSortTournaments"],setup(m){const{t:_}=z(),s=K(),w=m,d=x(w.adminCountTournaments);V(d,o=>{k.put(route("admin.settings.updateAdminCountTournaments"),{value:o},{preserveScroll:!0,preserveState:!0,onSuccess:()=>s.info(`Показ ${o} элементов на странице.`),onError:t=>s.error(t.value||"Ошибка обновления кол-ва элементов.")})});const c=x(w.adminSortTournaments);V(c,o=>{k.put(route("admin.settings.updateAdminSortTournaments"),{value:o},{preserveScroll:!0,preserveState:!0,onSuccess:()=>s.info("Сортировка успешно изменена"),onError:t=>s.error(t.value||"Ошибка обновления сортировки.")})});const S=x(!1),b=x(null),f=x(""),L=(o,t)=>{b.value=o,f.value=t,S.value=!0},T=()=>{S.value=!1,b.value=null,f.value=""},C=()=>{if(b.value===null)return;const o=b.value,t=f.value;k.delete(route("admin.tournaments.destroy",{tournament:o}),{preserveScroll:!0,preserveState:!1,onSuccess:a=>{T(),s.success(`Турнир "${t||"ID: "+o}" удален.`)},onError:a=>{T();const g=a.general||a[Object.keys(a)[0]]||"Произошла ошибка при удалении.";s.error(`${g} (Турнир: ${t||"ID: "+o})`),console.error("Ошибка удаления:",a)},onFinish:()=>{b.value=null,f.value=""}})},r=o=>{const t=!o.activity,a=t?"активирован":"деактивирован";k.put(route("admin.actions.tournaments.updateActivity",{tournament:o.id}),{activity:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{s.success(`Турнир "${o.name}" ${a}.`)},onError:g=>{s.error(g.activity||g.general||`Ошибка изменения активности для "${o.name}".`)}})},p=x(1),i=x(""),A=o=>c.value==="idAsc"?o.slice().sort((t,a)=>t.id-a.id):c.value==="idDesc"?o.slice().sort((t,a)=>a.id-t.id):c.value==="activity"?o.filter(t=>t.activity):c.value==="inactive"?o.filter(t=>!t.activity):c.value==="locale"?o.slice().sort((t,a)=>t.locale<a.locale?1:t.locale>a.locale?-1:0):c.value==="views"?o.slice().sort((t,a)=>a[c.value]-t[c.value]):o.slice().sort((t,a)=>t[c.value]<a[c.value]?-1:t[c.value]>a[c.value]?1:0),M=B(()=>{let o=w.tournaments;return i.value&&(o=o.filter(t=>t.name.toLowerCase().includes(i.value.toLowerCase()))),A(o)}),U=B(()=>{const o=(p.value-1)*d.value;return M.value.slice(o,o+d.value)});B(()=>Math.ceil(M.value.length/d.value));const N=o=>{const t=(p.value-1)*d.value,a=o.map((g,J)=>({id:g,sort:t+J+1}));k.put(route("admin.actions.tournaments.updateSortBulk"),{tournaments:a},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{s.success("Порядок турниров успешно обновлен.")},onError:g=>{console.error("Ошибка обновления сортировки:",g),s.error(g.general||g.tournaments||"Не удалось обновить порядок турниров."),k.reload({only:["tournaments"],preserveScroll:!0})}})},u=x([]),I=({ids:o,checked:t})=>{t?u.value=[...new Set([...u.value,...o])]:u.value=u.value.filter(a=>!o.includes(a))},O=o=>{const t=u.value.indexOf(o);t>-1?u.value.splice(t,1):u.value.push(o)},E=o=>{if(!u.value.length){s.warning("Выберите теги для активации/деактивации турниров");return}axios.put(route("admin.actions.tournaments.bulkUpdateActivity"),{ids:u.value,activity:o}).then(()=>{s.success("Активность массово обновлена");const t=[...u.value];u.value=[],U.value.forEach(a=>{t.includes(a.id)&&(a.activity=o)})}).catch(()=>{s.error("Не удалось обновить активность")})},F=()=>{if(u.value.length===0){s.warning("Выберите хотя бы один тег для удаления.");return}confirm("Вы уверены, что хотите их удалить ?")&&k.delete(route("admin.actions.tournaments.bulkDestroy"),{data:{ids:u.value},preserveScroll:!0,preserveState:!1,onSuccess:o=>{u.value=[],s.success("Массовое удаление турниров успешно завершено.")},onError:o=>{console.error("Ошибка массового удаления:",o);const t=Object.keys(o)[0],a=o[t]||"Произошла ошибка при удалении турниров.";s.error(a)}})},H=o=>{const t=o.target.value;t==="selectAll"?u.value=U.value.map(a=>a.id):t==="deselectAll"?u.value=[]:t==="activate"?E(!0):t==="deactivate"?E(!1):t==="delete"&&F(),o.target.value=""};return(o,t)=>(v(),D(Q,{title:n(_)("tournaments")},{header:$(()=>[h(R,null,{default:$(()=>[j(l(n(_)("tournaments")),1)]),_:1})]),default:$(()=>[e("div",Dt,[e("div",Pt,[e("div",zt,[h(q,{href:o.route("admin.tournaments.create")},{icon:$(()=>[Lt]),default:$(()=>[j(" "+l(n(_)("addTournament")),1)]),_:1},8,["href"]),m.tournamentsCount?(v(),D(ht,{key:0,onChange:H})):P("",!0)]),m.tournamentsCount?(v(),D(Z,{key:0,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=a=>i.value=a),placeholder:n(_)("searchByName")},null,8,["modelValue","placeholder"])):P("",!0),m.tournamentsCount?(v(),D(X,{key:1},{default:$(()=>[j(l(m.tournamentsCount),1)]),_:1})):P("",!0),h(rt,{tournaments:U.value,"selected-tournaments":u.value,onToggleActivity:r,onUpdateSortOrder:N,onDelete:L,onToggleSelect:O,onToggleAll:I},null,8,["tournaments","selected-tournaments"]),m.tournamentsCount?(v(),y("div",Mt,[h(ee,{"items-per-page":d.value,"onUpdate:itemsPerPage":t[1]||(t[1]=a=>d.value=a)},null,8,["items-per-page"]),h(te,{"current-page":p.value,"items-per-page":d.value,"total-items":M.value.length,"onUpdate:currentPage":t[2]||(t[2]=a=>p.value=a),"onUpdate:itemsPerPage":t[3]||(t[3]=a=>d.value=a)},null,8,["current-page","items-per-page","total-items"]),h(Ct,{sortParam:c.value,"onUpdate:sortParam":t[4]||(t[4]=a=>c.value=a)},null,8,["sortParam"])])):P("",!0)])]),h(Y,{show:S.value,onClose:T,onCancel:T,onConfirm:C,cancelText:n(_)("cancel"),confirmText:n(_)("yesDelete")},null,8,["show","cancelText","confirmText"])]),_:1},8,["title"]))}};export{qt as default};
